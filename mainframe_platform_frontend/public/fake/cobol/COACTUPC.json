{
  "id": "97eb5689f2df40fe9fe3c41d8c9ff21a",
  "name": "COACTUPC",
  "path": "DEMO.CARDDEMO.CBL/COACTUPC",
  "label": "COBOL",
  "overview": {
    "programe_name": "COACTUPC",
    "io_files": [],
    "db_accesses": [],
    "copy_files": [
      "'CSUTLDWY'",
      "CVCRD01Y",
      "CSLKPCDY",
      "DFHBMSCA",
      "DFHAID",
      "COTTL01Y",
      "COACTUP",
      "CSDAT01Y",
      "CSMSG01Y",
      "CSMSG02Y",
      "CSUSR01Y",
      "CVACT01Y",
      "CVACT03Y",
      "CVCUS01Y",
      "COCOM01Y",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "CSSETATY",
      "'CSSTRPFY'",
      "CSUTLDPY"
    ],
    "call_files": [],
    "summarization": "This section of COBOL code is structured to manage an interactive user session for updating account and customer information in a CICS environment. Here is a breakdown of the overall flow:\n\n1. **Initialize Session (0000-MAIN)**:\n   - Handle abnormal terminations using `EXEC CICS HANDLE ABEND`.\n   - Initialize work areas (e.g., `CC-WORK-AREA`, `WS-MISC-STORAGE`, `WS-COMMAREA`).\n   - Store transaction context and set error message status.\n   - Initialize data areas or load passed data from `DFHCOMMAREA`.\n\n2. **Process User Inputs**:\n   - Remap and store PF keys.\n   - Validate Action Identifiers like `CCARD-AID-ENTER`, `CCARD-AID-PFK03`, etc., marking invalid ones.\n   - Use `EVALUATE TRUE` to control flow based on inputs:\n     - **PF03 (Exit)**: Prepare for exit by setting transfer program details and managing `COMMAREA`.\n     - **Initial Entry**: If details not fetched, prompt for search keys.\n     - **Operations on Data Changes**: Manage updates, validation, and send appropriate maps.\n\n3. **Common Return (`COMMON-RETURN`)**:\n   - Transmit session continuation details using `CICS RETURN`.\n\n4. **Input Processing (`1000-PROCESS-INPUTS` and subroutines)**:\n   - Receive map data and edit inputs.\n   - Validate various data elements (Account IDs, dates, SSNs, phone numbers, names, etc.).\n   - Compare old and new data to detect changes.\n\n5. **Decision Making (`2000-DECIDE-ACTION`)**:\n   - Determine actions based on whether details were fetched, edited, confirmed, etc.\n   - Update data or re-prompt user based on scenario.\n\n6. **Screen Handling (`3000-SEND-MAP` and related subroutines)**:\n   - Setup screen fields with appropriate values based on current session.\n   - Handle attribute protection/unprotection for fields.\n   - Send screen to user with `CICS SEND`.\n\n7. **Data Fetching for Update (`9000-READ-ACCT` and related subroutines)**:\n   - Read account and customer data from files.\n   - Store fetched data in working storage.\n\n8. **Data Writing (`9600-WRITE-PROCESSING` and subroutines)**:\n   - Prepare and execute updates, handle locking and potential rollback in case of errors.\n\n9. **Error Handling and Abend Routine (`ABEND-ROUTINE`)**:\n   - Handle unexpected errors and send appropriate messages before executing `CICS ABEND`.\n\nThe code ensures that all inputs are validated, updates are locked and verified, and necessary actions are taken based on user interactions within the CICS environment. Specific tables used in different parts include `CARDDEMO-COMMAREA` and data records such as `ACCOUNT-RECORD` and `CUSTOMER-RECORD`.",
    "io_table": []
  },
  "io_params_def": {
    "input_table": [
      {
        "item_name": "DFHCOMMAREA",
        "cobol_level": "01",
        "cobol_dtype": "",
        "length": "",
        "access_mode": "I-O",
        "dtype": "",
        "default_value": "",
        "remarks": "Java DTO class equivalence"
      },
      {
        "item_name": "   FILLER",
        "cobol_level": "05",
        "cobol_dtype": "X",
        "length": "1",
        "access_mode": "I-O",
        "dtype": "String",
        "default_value": "",
        "remarks": "Java String data type equivalence"
      }
    ],
    "input_note": "",
    "output_table": [
      {
        "item_name": "DFHCOMMAREA",
        "cobol_level": "01",
        "cobol_dtype": "",
        "length": "",
        "access_mode": "I-O",
        "dtype": "",
        "default_value": "",
        "remarks": "Java DTO class equivalence"
      },
      {
        "item_name": "   FILLER",
        "cobol_level": "05",
        "cobol_dtype": "X",
        "length": "1",
        "access_mode": "I-O",
        "dtype": "String",
        "default_value": "",
        "remarks": "Java String data type equivalence"
      }
    ],
    "output_note": ""
  },
  "process_logic": {
    "paragraph_level": {
      "0000-MAIN": {
        "paragraph_name": "0000-MAIN",
        "section": "procedure division",
        "paragraph_code": "0000-MAIN.\n\n\n           EXEC CICS HANDLE ABEND\n                     LABEL(ABEND-ROUTINE)\n           END-EXEC\n\n           INITIALIZE CC-WORK-AREA\n                      WS-MISC-STORAGE\n                      WS-COMMAREA\n      *****************************************************************\n      * Store our context\n      *****************************************************************\n           MOVE LIT-THISTRANID       TO WS-TRANID\n      *****************************************************************\n      * Ensure error message is cleared                               *\n      *****************************************************************\n           SET WS-RETURN-MSG-OFF  TO TRUE\n      *****************************************************************\n      * Store passed data if  any                *\n      *****************************************************************\n           IF EIBCALEN IS EQUAL TO 0\n               OR (CDEMO-FROM-PROGRAM = LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER)\n              INITIALIZE CARDDEMO-COMMAREA\n                         WS-THIS-PROGCOMMAREA\n              SET CDEMO-PGM-ENTER TO TRUE\n              SET ACUP-DETAILS-NOT-FETCHED TO TRUE\n           ELSE\n              MOVE DFHCOMMAREA (1:LENGTH OF CARDDEMO-COMMAREA)  TO\n                                CARDDEMO-COMMAREA\n              MOVE DFHCOMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                               LENGTH OF WS-THIS-PROGCOMMAREA ) TO\n                                WS-THIS-PROGCOMMAREA\n           END-IF\n      *****************************************************************\n      * Remap PFkeys as needed.\n      * Store the Mapped PF Key\n      *****************************************************************\n           PERFORM YYYY-STORE-PFKEY\n              THRU YYYY-STORE-PFKEY-EXIT\n      *****************************************************************\n      * Check the AID to see if its valid at this point               *\n      * F3 - Exit\n      * Enter show screen again\n      *****************************************************************\n           SET PFK-INVALID TO TRUE\n           IF CCARD-AID-ENTER OR\n              CCARD-AID-PFK03 OR\n              (CCARD-AID-PFK05 AND ACUP-CHANGES-OK-NOT-CONFIRMED)\n                              OR\n              (CCARD-AID-PFK12 AND NOT ACUP-DETAILS-NOT-FETCHED)\n              SET PFK-VALID TO TRUE\n           END-IF\n\n           IF PFK-INVALID\n              SET CCARD-AID-ENTER TO TRUE\n           END-IF\n\n      *****************************************************************\n      * Decide what to do based on inputs received\n      *****************************************************************\n           EVALUATE TRUE\n      ******************************************************************\n      *       USER PRESSES PF03 TO EXIT\n      *  OR   USER IS DONE WITH UPDATE\n      *            XCTL TO CALLING PROGRAM OR MAIN MENU\n      ******************************************************************\n              WHEN CCARD-AID-PFK03\n                   SET CCARD-AID-PFK03     TO TRUE\n\n                   IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES\n                   OR CDEMO-FROM-TRANID    EQUAL SPACES\n                      MOVE LIT-MENUTRANID  TO CDEMO-TO-TRANID\n                   ELSE\n                      MOVE CDEMO-FROM-TRANID  TO CDEMO-TO-TRANID\n                   END-IF\n\n                   IF CDEMO-FROM-PROGRAM   EQUAL LOW-VALUES\n                   OR CDEMO-FROM-PROGRAM   EQUAL SPACES\n                      MOVE LIT-MENUPGM     TO CDEMO-TO-PROGRAM\n                   ELSE\n                      MOVE CDEMO-FROM-PROGRAM TO CDEMO-TO-PROGRAM\n                   END-IF\n\n                   MOVE LIT-THISTRANID     TO CDEMO-FROM-TRANID\n                   MOVE LIT-THISPGM        TO CDEMO-FROM-PROGRAM\n\n                   SET  CDEMO-USRTYP-USER  TO TRUE\n                   SET  CDEMO-PGM-ENTER    TO TRUE\n                   MOVE LIT-THISMAPSET     TO CDEMO-LAST-MAPSET\n                   MOVE LIT-THISMAP        TO CDEMO-LAST-MAP\n\n                   EXEC CICS\n                        SYNCPOINT\n                   END-EXEC\n      *\n                   EXEC CICS XCTL\n                        PROGRAM (CDEMO-TO-PROGRAM)\n                        COMMAREA(CARDDEMO-COMMAREA)\n                   END-EXEC\n      ******************************************************************\n      *       FRESH ENTRY INTO PROGRAM\n      *            ASK THE USER FOR THE KEYS TO FETCH CARD TO BE UPDATED\n      ******************************************************************\n              WHEN ACUP-DETAILS-NOT-FETCHED\n               AND CDEMO-PGM-ENTER\n              WHEN CDEMO-FROM-PROGRAM   EQUAL LIT-MENUPGM\n               AND NOT CDEMO-PGM-REENTER\n                   INITIALIZE WS-THIS-PROGCOMMAREA\n                   PERFORM 3000-SEND-MAP THRU\n                           3000-SEND-MAP-EXIT\n                   SET CDEMO-PGM-REENTER        TO TRUE\n                   SET ACUP-DETAILS-NOT-FETCHED TO TRUE\n                   GO TO COMMON-RETURN\n      ******************************************************************\n      *       ACCT DATA CHANGES REVIEWED, OKAYED AND DONE SUCESSFULLY\n      *            RESET THE SEARCH KEYS\n      *            ASK THE USER FOR FRESH SEARCH CRITERIA\n      ******************************************************************\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n              WHEN ACUP-CHANGES-FAILED\n                   INITIALIZE WS-THIS-PROGCOMMAREA\n                              WS-MISC-STORAGE\n                              CDEMO-ACCT-ID\n                   SET CDEMO-PGM-ENTER            TO TRUE\n                   PERFORM 3000-SEND-MAP THRU\n                           3000-SEND-MAP-EXIT\n                   SET CDEMO-PGM-REENTER          TO TRUE\n                   SET ACUP-DETAILS-NOT-FETCHED   TO TRUE\n                   GO TO COMMON-RETURN\n      ******************************************************************\n      *      ACCT DATA HAS BEEN PRESENTED TO USER\n      *            CHECK THE USER INPUTS\n      *            DECIDE WHAT TO DO\n      *            PRESENT NEXT STEPS TO USER\n      ******************************************************************\n              WHEN OTHER\n                   PERFORM 1000-PROCESS-INPUTS\n                      THRU 1000-PROCESS-INPUTS-EXIT\n                   PERFORM 2000-DECIDE-ACTION\n                      THRU 2000-DECIDE-ACTION-EXIT\n                   PERFORM 3000-SEND-MAP\n                      THRU 3000-SEND-MAP-EXIT\n                   GO TO COMMON-RETURN\n           END-EVALUATE\n           .\n\n",
        "paragraph_lines": [861, 1007],
        "ref_paragraphs": [
          "YYYY-STORE-PFKEY",
          "YYYY-STORE-PFKEY-EXIT",
          "3000-SEND-MAP",
          "3000-SEND-MAP-EXIT",
          "3000-SEND-MAP",
          "3000-SEND-MAP-EXIT",
          "1000-PROCESS-INPUTS",
          "1000-PROCESS-INPUTS-EXIT",
          "2000-DECIDE-ACTION",
          "2000-DECIDE-ACTION-EXIT",
          "3000-SEND-MAP",
          "3000-SEND-MAP-EXIT"
        ],
        "paragraph_logic": [
          "Handles any system abends, directing them to the ABEND-ROUTINE.",
          "Initializes various working storage areas like CC-WORK-AREA, WS-MISC-STORAGE, and WS-COMMAREA to prepare for processing.",
          "Stores the transaction ID in WS-TRANID and sets the initial state for error messages and re-enter flags.",
          "Stores or initializes the communication areas (CARDDEMO-COMMAREA) based on conditions and incoming data size.",
          "Remaps PF keys and stores the mapped PF key by calling [store PF key process]<YYYY-STORE-PFKEY>.",
          "Evaluates received inputs and decides the course of action, potentially calling processing paragraphs such as [process inputs]<1000-PROCESS-INPUTS> or [send map process]<3000-SEND-MAP>."
        ]
      },
      "COMMON-RETURN": {
        "paragraph_name": "COMMON-RETURN",
        "section": "procedure division",
        "paragraph_code": "COMMON-RETURN.\n           MOVE WS-RETURN-MSG     TO CCARD-ERROR-MSG\n\n           MOVE  CARDDEMO-COMMAREA    TO WS-COMMAREA\n           MOVE  WS-THIS-PROGCOMMAREA TO\n                  WS-COMMAREA(LENGTH OF CARDDEMO-COMMAREA + 1:\n                               LENGTH OF WS-THIS-PROGCOMMAREA )\n\n           EXEC CICS RETURN\n                TRANSID (LIT-THISTRANID)\n                COMMAREA (WS-COMMAREA)\n                LENGTH(LENGTH OF WS-COMMAREA)\n           END-EXEC\n           .\n",
        "paragraph_lines": [1009, 1022],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Copies the return message from working storage to the error message field.",
          "Moves data from the CARDDEMO communication area to the working storage communication area for further processing.",
          "Appends specific program-related data to the working storage communication area.",
          "Returns control to the CICS transaction, passing the updated communication area and the transaction ID."
        ]
      },
      "0000-MAIN-EXIT": {
        "paragraph_name": "0000-MAIN-EXIT",
        "section": "procedure division",
        "paragraph_code": "0000-MAIN-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [1023, 1025],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the main program block, relinquishing control back to the calling program or operating system."
        ]
      },
      "1000-PROCESS-INPUTS": {
        "paragraph_name": "1000-PROCESS-INPUTS",
        "section": "procedure division",
        "paragraph_code": "1000-PROCESS-INPUTS.\n           PERFORM 1100-RECEIVE-MAP\n              THRU 1100-RECEIVE-MAP-EXIT\n           PERFORM 1200-EDIT-MAP-INPUTS\n              THRU 1200-EDIT-MAP-INPUTS-EXIT\n           MOVE WS-RETURN-MSG  TO CCARD-ERROR-MSG\n           MOVE LIT-THISPGM    TO CCARD-NEXT-PROG\n           MOVE LIT-THISMAPSET TO CCARD-NEXT-MAPSET\n           MOVE LIT-THISMAP    TO CCARD-NEXT-MAP\n           .\n",
        "paragraph_lines": [1027, 1036],
        "ref_paragraphs": [
          "1100-RECEIVE-MAP",
          "1100-RECEIVE-MAP-EXIT",
          "1200-EDIT-MAP-INPUTS",
          "1200-EDIT-MAP-INPUTS-EXIT"
        ],
        "paragraph_logic": [
          "Calls the [map receiving process]<1100-RECEIVE-MAP> to capture input data from the user or screen.",
          "Calls the [map input editing process]<1200-EDIT-MAP-INPUTS> to validate and edit the input data for any errors.",
          "Moves the return message from the working storage to the card error message field for display.",
          "Sets the program name in the next program field to indicate which program to call next.",
          "Sets the mapset name in the next mapset field to indicate the set of maps to use next.",
          "Sets the map name in the next map field to specify which map to display next."
        ]
      },
      "1000-PROCESS-INPUTS-EXIT": {
        "paragraph_name": "1000-PROCESS-INPUTS-EXIT",
        "section": "procedure division",
        "paragraph_code": "1000-PROCESS-INPUTS-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [1038, 1040],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the end of the input processing paragraph and exits the procedure division."
        ]
      },
      "1100-RECEIVE-MAP": {
        "paragraph_name": "1100-RECEIVE-MAP",
        "section": "procedure division",
        "paragraph_code": "1100-RECEIVE-MAP.\n           EXEC CICS RECEIVE MAP(LIT-THISMAP)\n                     MAPSET(LIT-THISMAPSET)\n                     INTO(CACTUPAI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC\n      *\n           INITIALIZE ACUP-NEW-DETAILS\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           IF  ACCTSIDI OF CACTUPAI = '*'\n           OR  ACCTSIDI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO CC-ACCT-ID\n                                            ACUP-NEW-ACCT-ID-X\n           ELSE\n               MOVE ACCTSIDI OF CACTUPAI TO CC-ACCT-ID\n                                            ACUP-NEW-ACCT-ID-X\n           END-IF\n\n           IF ACUP-DETAILS-NOT-FETCHED\n              GO TO 1100-RECEIVE-MAP-EXIT\n           END-IF\n\n      * Active Status\n           IF  ACSTTUSI OF CACTUPAI = '*'\n           OR  ACSTTUSI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-ACTIVE-STATUS\n           ELSE\n               MOVE ACSTTUSI OF CACTUPAI TO ACUP-NEW-ACTIVE-STATUS\n           END-IF\n\n      * Credit Limit\n           IF  ACRDLIMI OF CACTUPAI = '*'\n           OR  ACRDLIMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CREDIT-LIMIT-X\n           ELSE\n               MOVE ACRDLIMI OF CACTUPAI TO ACUP-NEW-CREDIT-LIMIT-X\n               IF ACUP-NEW-CREDIT-LIMIT-X IS  NUMERIC\n                  MOVE  ACUP-NEW-CREDIT-LIMIT  TO\n                                      ACRDLIMI OF CACTUPAI\n               ELSE\n                  CONTINUE\n               END-IF\n           END-IF\n\n      * Cash Limit\n           IF  ACSHLIMI OF CACTUPAI = '*'\n           OR  ACSHLIMI OF CACTUPAI = SPACES\n             MOVE LOW-VALUES           TO ACUP-NEW-CASH-CREDIT-LIMIT-X\n           ELSE\n             MOVE ACSHLIMI OF CACTUPAI TO ACUP-NEW-CASH-CREDIT-LIMIT-X\n             IF ACUP-NEW-CASH-CREDIT-LIMIT-X IS NUMERIC\n                MOVE    ACUP-NEW-CASH-CREDIT-LIMIT    TO\n                                       ACSHLIMI OF CACTUPAI\n             ELSE\n                CONTINUE\n             END-IF\n           END-IF\n\n      * Current Balance\n           IF  ACURBALI OF CACTUPAI = '*'\n           OR  ACURBALI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-BAL-X\n           ELSE\n               MOVE ACURBALI OF CACTUPAI TO ACUP-NEW-CURR-BAL-X\n               IF  ACUP-NEW-CURR-BAL-X IS NUMERIC\n                   MOVE  ACUP-NEW-CURR-BAL-N  OF ACUP-NEW-DETAILS TO\n                         ACUP-NEW-CURR-BAL-N  OF\n                         ALPHA-VARS-FOR-DATA-EDITING\n               ELSE\n                   CONTINUE\n               END-IF\n           END-IF\n\n      *Current Cycle Credit\n           IF  ACRCYCRI OF CACTUPAI = '*'\n           OR  ACRCYCRI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-CREDIT-X\n           ELSE\n               MOVE ACRCYCRI OF CACTUPAI TO ACUP-NEW-CURR-CYC-CREDIT\n           END-IF\n\n      *Current Cycle Debit\n           IF  ACRCYDBI OF CACTUPAI = '*'\n           OR  ACRCYDBI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CURR-CYC-DEBIT-X\n           ELSE\n               MOVE ACRCYDBI OF CACTUPAI TO ACUP-NEW-CURR-CYC-DEBIT\n           END-IF\n\n      *Open date\n      *\n           IF  OPNYEARI OF CACTUPAI = '*'\n           OR  OPNYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-YEAR\n           ELSE\n               MOVE OPNYEARI OF CACTUPAI TO ACUP-NEW-OPEN-YEAR\n           END-IF\n\n           IF  OPNMONI OF CACTUPAI = '*'\n           OR  OPNMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-MON\n           ELSE\n               MOVE OPNMONI OF CACTUPAI TO  ACUP-NEW-OPEN-MON\n           END-IF\n\n           IF  OPNDAYI OF CACTUPAI = '*'\n           OR  OPNDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-OPEN-DAY\n           ELSE\n               MOVE OPNDAYI OF CACTUPAI TO  ACUP-NEW-OPEN-DAY\n           END-IF\n\n      *Expiry date\n      *\n           IF  EXPYEARI OF CACTUPAI = '*'\n           OR  EXPYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-YEAR\n           ELSE\n               MOVE EXPYEARI OF CACTUPAI TO ACUP-NEW-EXP-YEAR\n           END-IF\n\n           IF  EXPMONI OF CACTUPAI = '*'\n           OR  EXPMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-MON\n           ELSE\n               MOVE EXPMONI OF CACTUPAI TO  ACUP-NEW-EXP-MON\n           END-IF\n\n           IF  EXPDAYI OF CACTUPAI = '*'\n           OR  EXPDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-EXP-DAY\n           ELSE\n               MOVE EXPDAYI OF CACTUPAI TO  ACUP-NEW-EXP-DAY\n           END-IF\n\n      *Reissue date\n      *\n           IF  RISYEARI OF CACTUPAI = '*'\n           OR  RISYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-YEAR\n           ELSE\n               MOVE RISYEARI OF CACTUPAI TO ACUP-NEW-REISSUE-YEAR\n           END-IF\n\n           IF  RISMONI OF CACTUPAI = '*'\n           OR  RISMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-MON\n           ELSE\n               MOVE RISMONI OF CACTUPAI TO  ACUP-NEW-REISSUE-MON\n           END-IF\n\n           IF  RISDAYI OF CACTUPAI = '*'\n           OR  RISDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-REISSUE-DAY\n           ELSE\n               MOVE RISDAYI OF CACTUPAI TO  ACUP-NEW-REISSUE-DAY\n           END-IF\n\n      *Account Group\n      *\n           IF  AADDGRPI OF CACTUPAI = '*'\n           OR  AADDGRPI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-GROUP-ID\n           ELSE\n               MOVE AADDGRPI OF CACTUPAI TO ACUP-NEW-GROUP-ID\n           END-IF\n      ******************************************************************\n      *    Customer Master data\n      ******************************************************************\n      *Customer Id (actually not editable)\n      *\n           IF  ACSTNUMI OF CACTUPAI = '*'\n           OR  ACSTNUMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ID-X\n           ELSE\n               MOVE ACSTNUMI OF CACTUPAI TO ACUP-NEW-CUST-ID-X\n           END-IF\n\n      *Social Security Number\n      *\n           IF  ACTSSN1I OF CACTUPAI = '*'\n           OR  ACTSSN1I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-1\n           ELSE\n               MOVE ACTSSN1I OF CACTUPAI TO ACUP-NEW-CUST-SSN-1\n           END-IF\n\n           IF  ACTSSN2I OF CACTUPAI = '*'\n           OR  ACTSSN2I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-2\n           ELSE\n               MOVE ACTSSN2I OF CACTUPAI TO ACUP-NEW-CUST-SSN-2\n           END-IF\n\n           IF  ACTSSN3I OF CACTUPAI = '*'\n           OR  ACTSSN3I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-SSN-3\n           ELSE\n               MOVE ACTSSN3I OF CACTUPAI TO ACUP-NEW-CUST-SSN-3\n           END-IF\n      *\n      *Date of birth\n      *\n           IF  DOBYEARI OF CACTUPAI = '*'\n           OR  DOBYEARI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-YEAR\n           ELSE\n               MOVE DOBYEARI OF CACTUPAI TO ACUP-NEW-CUST-DOB-YEAR\n           END-IF\n\n           IF  DOBMONI OF CACTUPAI = '*'\n           OR  DOBMONI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-MON\n           ELSE\n               MOVE DOBMONI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-MON\n           END-IF\n\n           IF  DOBDAYI OF CACTUPAI = '*'\n           OR  DOBDAYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-DOB-DAY\n           ELSE\n               MOVE DOBDAYI OF CACTUPAI  TO ACUP-NEW-CUST-DOB-DAY\n           END-IF\n      *\n      *FICO\n      *\n           IF  ACSTFCOI OF CACTUPAI = '*'\n           OR  ACSTFCOI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-FICO-SCORE-X\n           ELSE\n               MOVE ACSTFCOI OF CACTUPAI TO ACUP-NEW-CUST-FICO-SCORE-X\n           END-IF\n      *\n      *First Name\n      *\n           IF  ACSFNAMI OF CACTUPAI = '*'\n           OR  ACSFNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-FIRST-NAME\n           ELSE\n               MOVE ACSFNAMI OF CACTUPAI TO ACUP-NEW-CUST-FIRST-NAME\n           END-IF\n      *\n      *Middle Name\n      *\n           IF  ACSMNAMI OF CACTUPAI = '*'\n           OR  ACSMNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-MIDDLE-NAME\n           ELSE\n               MOVE ACSMNAMI OF CACTUPAI TO ACUP-NEW-CUST-MIDDLE-NAME\n           END-IF\n      *\n      *Last Name\n      *\n           IF  ACSLNAMI OF CACTUPAI = '*'\n           OR  ACSLNAMI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-LAST-NAME\n           ELSE\n               MOVE ACSLNAMI OF CACTUPAI TO ACUP-NEW-CUST-LAST-NAME\n           END-IF\n      *\n      *Address\n      *\n           IF  ACSADL1I OF CACTUPAI = '*'\n           OR  ACSADL1I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-1\n           ELSE\n               MOVE ACSADL1I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-1\n           END-IF\n\n           IF  ACSADL2I OF CACTUPAI = '*'\n           OR  ACSADL2I OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-2\n           ELSE\n               MOVE ACSADL2I OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-2\n           END-IF\n\n           IF  ACSCITYI OF CACTUPAI = '*'\n           OR  ACSCITYI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-LINE-3\n           ELSE\n               MOVE ACSCITYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-LINE-3\n           END-IF\n\n           IF  ACSSTTEI OF CACTUPAI = '*'\n           OR  ACSSTTEI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-STATE-CD\n           ELSE\n               MOVE ACSSTTEI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-STATE-CD\n           END-IF\n\n           IF  ACSCTRYI OF CACTUPAI = '*'\n           OR  ACSCTRYI OF CACTUPAI = SPACES\n              MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-COUNTRY-CD\n           ELSE\n              MOVE ACSCTRYI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-COUNTRY-CD\n           END-IF\n\n           IF  ACSZIPCI OF CACTUPAI = '*'\n           OR  ACSZIPCI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-ADDR-ZIP\n           ELSE\n               MOVE ACSZIPCI OF CACTUPAI TO ACUP-NEW-CUST-ADDR-ZIP\n           END-IF\n\n           IF  ACSPH1AI OF CACTUPAI = '*'\n           OR  ACSPH1AI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1A\n           ELSE\n               MOVE ACSPH1AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1A\n           END-IF\n\n           IF  ACSPH1BI OF CACTUPAI = '*'\n           OR  ACSPH1BI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1B\n           ELSE\n               MOVE ACSPH1BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1B\n           END-IF\n\n           IF  ACSPH1CI OF CACTUPAI = '*'\n           OR  ACSPH1CI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-1C\n           ELSE\n               MOVE ACSPH1CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-1C\n           END-IF\n\n           IF  ACSPH2AI OF CACTUPAI = '*'\n           OR  ACSPH2AI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2A\n           ELSE\n               MOVE ACSPH2AI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2A\n           END-IF\n\n           IF  ACSPH2BI OF CACTUPAI = '*'\n           OR  ACSPH2BI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2B\n           ELSE\n               MOVE ACSPH2BI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2B\n           END-IF\n\n           IF  ACSPH2CI OF CACTUPAI = '*'\n           OR  ACSPH2CI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-PHONE-NUM-2C\n           ELSE\n               MOVE ACSPH2CI OF CACTUPAI TO ACUP-NEW-CUST-PHONE-NUM-2C\n           END-IF\n      *\n      *Government Id\n      *\n           IF  ACSGOVTI OF CACTUPAI = '*'\n           OR  ACSGOVTI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-GOVT-ISSUED-ID\n           ELSE\n               MOVE ACSGOVTI OF CACTUPAI TO ACUP-NEW-CUST-GOVT-ISSUED-ID\n           END-IF\n      *\n      *EFT Code\n      *\n           IF  ACSEFTCI OF CACTUPAI = '*'\n           OR  ACSEFTCI OF CACTUPAI = SPACES\n               MOVE LOW-VALUES           TO ACUP-NEW-CUST-EFT-ACCOUNT-ID\n           ELSE\n               MOVE ACSEFTCI OF CACTUPAI TO ACUP-NEW-CUST-EFT-ACCOUNT-ID\n           END-IF\n      *\n      *Primary Holder Indicator\n      *\n           IF  ACSPFLGI OF CACTUPAI = '*'\n           OR  ACSPFLGI OF CACTUPAI = SPACES\n              MOVE LOW-VALUES            TO ACUP-NEW-CUST-PRI-HOLDER-IND\n           ELSE\n              MOVE ACSPFLGI OF CACTUPAI  TO ACUP-NEW-CUST-PRI-HOLDER-IND\n           END-IF\n           .\n",
        "paragraph_lines": [1041, 1416],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Receives the map data from the screen using CICS RECEIVE command and loads it into the CACTUPAI data structure.",
          "Populates the account details from the received data into the ACUP-NEW-DETAILS structure, ensuring unfilled fields are set to low-values.",
          "Populates customer master data fields from received data, converting any empty fields to low-values.",
          "Ensures all date and numeric fields within the data are correctly handled, converting empty fields to low-values.",
          "Moves address and phone number details from the received map fields to ACUP-NEW-DETAILS, converting empty fields as needed.",
          "Sets various attributes, such as Government ID, EFT Code, and Primary Holder Indicator, handling empty values appropriately."
        ]
      },
      "1100-RECEIVE-MAP-EXIT": {
        "paragraph_name": "1100-RECEIVE-MAP-EXIT",
        "section": "procedure division",
        "paragraph_code": "1100-RECEIVE-MAP-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [1417, 1419],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the paragraph [receive map process]<1100-RECEIVE-MAP-EXIT>, marking the end of its execution."
        ]
      },
      "1200-EDIT-MAP-INPUTS": {
        "paragraph_name": "1200-EDIT-MAP-INPUTS",
        "section": "procedure division",
        "paragraph_code": "1200-EDIT-MAP-INPUTS.\n\n           SET INPUT-OK                  TO TRUE\n\n           IF  ACUP-DETAILS-NOT-FETCHED\n      *        VALIDATE THE SEARCH KEYS\n               PERFORM 1210-EDIT-ACCOUNT\n                  THRU 1210-EDIT-ACCOUNT-EXIT\n\n               MOVE LOW-VALUES           TO ACUP-OLD-ACCT-DATA\n\n      *       IF THE SEARCH CONDITIONS HAVE PROBLEMS FLAG THEM\n              IF  FLG-ACCTFILTER-BLANK\n                  SET NO-SEARCH-CRITERIA-RECEIVED TO TRUE\n              END-IF\n\n      *       AT THIS STAGE. NO DETAILS FETCHED. NOTHING MORE TO EDIT.\n              GO TO 1200-EDIT-MAP-INPUTS-EXIT\n           ELSE\n               CONTINUE\n           END-IF\n      *\n      *    SEARCH KEYS ALREADY VALIDATED AND DATA FETCHED\n           SET FOUND-ACCOUNT-DATA        TO TRUE\n           SET FOUND-ACCT-IN-MASTER      TO TRUE\n           SET FLG-ACCTFILTER-ISVALID    TO TRUE\n\n           SET FOUND-CUST-IN-MASTER      TO TRUE\n           SET FLG-CUSTFILTER-ISVALID    TO TRUE\n\n      *\n           PERFORM 1205-COMPARE-OLD-NEW\n              THRU 1205-COMPARE-OLD-NEW-EXIT\n\n           IF  NO-CHANGES-FOUND\n           OR  ACUP-CHANGES-OK-NOT-CONFIRMED\n           OR  ACUP-CHANGES-OKAYED-AND-DONE\n               MOVE LOW-VALUES           TO WS-NON-KEY-FLAGS\n               GO TO 1200-EDIT-MAP-INPUTS-EXIT\n           END-IF\n\n           SET ACUP-CHANGES-NOT-OK       TO TRUE\n\n           MOVE 'Account Status'          TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-ACTIVE-STATUS    TO WS-EDIT-YES-NO\n           PERFORM 1220-EDIT-YESNO\n              THRU 1220-EDIT-YESNO-EXIT\n           MOVE WS-EDIT-YES-NO            TO WS-EDIT-ACCT-STATUS\n\n           MOVE 'Open Date'              TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-OPEN-DATE       TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-OPEN-DATE-FLGS\n\n           MOVE 'Credit Limit'           TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CREDIT-LIMIT-X  TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT  TO WS-EDIT-CREDIT-LIMIT\n\n           MOVE 'Expiry Date'            TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-EXPIRAION-DATE  TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EXPIRY-DATE-FLGS\n\n           MOVE 'Cash Credit Limit'      TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT TO WS-EDIT-CASH-CREDIT-LIMIT\n\n           MOVE 'Reissue Date'           TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-REISSUE-DATE    TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-REISSUE-DATE-FLGS\n\n           MOVE 'Current Balance'        TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-BAL-X      TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-BAL\n\n           MOVE 'Current Cycle Credit Limit' TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-CYC-CREDIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-CREDIT\n\n           MOVE 'Current Cycle Debit Limit' TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CURR-CYC-DEBIT-X\n                                         TO WS-EDIT-SIGNED-NUMBER-9V2-X\n           PERFORM 1250-EDIT-SIGNED-9V2\n              THRU 1250-EDIT-SIGNED-9V2-EXIT\n           MOVE WS-FLG-SIGNED-NUMBER-EDIT   TO WS-EDIT-CURR-CYC-DEBIT\n\n           MOVE 'SSN'                    TO WS-EDIT-VARIABLE-NAME\n           PERFORM 1265-EDIT-US-SSN\n              THRU 1265-EDIT-US-SSN-EXIT\n\n           MOVE 'Date of Birth'          TO WS-EDIT-VARIABLE-NAME\n           MOVE   ACUP-NEW-CUST-DOB-YYYY-MM-DD\n                                         TO WS-EDIT-DATE-CCYYMMDD\n           PERFORM EDIT-DATE-CCYYMMDD\n              THRU EDIT-DATE-CCYYMMDD-EXIT\n           MOVE WS-EDIT-DATE-FLGS        TO WS-EDIT-DT-OF-BIRTH-FLGS\n           IF WS-EDIT-DT-OF-BIRTH-ISVALID\n              PERFORM  EDIT-DATE-OF-BIRTH\n                 THRU  EDIT-DATE-OF-BIRTH-EXIT\n              MOVE WS-EDIT-DATE-FLGS    TO WS-EDIT-DT-OF-BIRTH-FLGS\n           END-IF\n\n           MOVE 'FICO Score'             TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-FICO-SCORE-X\n                                         TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-FICO-SCORE-FLGS\n           IF FLG-FICO-SCORE-ISVALID\n              PERFORM  1275-EDIT-FICO-SCORE\n                 THRU  1275-EDIT-FICO-SCORE-EXIT\n           END-IF\n      ******************************************************************\n      *    Edit names\n      ******************************************************************\n           MOVE 'First Name'             TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-FIRST-NAME TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-FIRST-NAME-FLGS\n\n           MOVE 'Middle Name'            TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-MIDDLE-NAME TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1235-EDIT-ALPHA-OPT\n              THRU 1235-EDIT-ALPHA-OPT-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-MIDDLE-NAME-FLGS\n\n           MOVE 'Last Name'              TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-LAST-NAME  TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 25                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                        TO WS-EDIT-LAST-NAME-FLGS\n\n           MOVE 'Address Line 1'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-LINE-1 TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1215-EDIT-MANDATORY\n              THRU 1215-EDIT-MANDATORY-EXIT\n           MOVE WS-EDIT-MANDATORY-FLAGS\n                                         TO WS-EDIT-ADDRESS-LINE-1-FLGS\n\n           MOVE 'State'                  TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 2                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-STATE-FLGS\n           IF FLG-ALPHA-ISVALID\n           PERFORM 1270-EDIT-US-STATE-CD\n              THRU 1270-EDIT-US-STATE-CD-EXIT\n           END-IF\n\n\n           MOVE 'Zip'                    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-ZIP   TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 5                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-ZIPCODE-FLGS\n\n      *    Address Line 2 is optional\n      *    MOVE 'Address Line 2'         TO WS-EDIT-VARIABLE-NAME\n           MOVE 'City'                   TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-LINE-3 TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 50                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-CITY-FLGS\n\n           MOVE 'Country'                TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD\n                                        TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1225-EDIT-ALPHA-REQD\n              THRU 1225-EDIT-ALPHA-REQD-EXIT\n           MOVE WS-EDIT-ALPHA-ONLY-FLAGS\n                                         TO WS-EDIT-COUNTRY-FLGS\n\n           MOVE 'Phone Number 1'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1\n                                         TO WS-EDIT-US-PHONE-NUM\n           PERFORM 1260-EDIT-US-PHONE-NUM\n              THRU 1260-EDIT-US-PHONE-NUM-EXIT\n           MOVE WS-EDIT-US-PHONE-NUM-FLGS\n                                         TO  WS-EDIT-PHONE-NUM-1-FLGS\n\n           MOVE 'Phone Number 2'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2\n                                         TO WS-EDIT-US-PHONE-NUM\n           PERFORM 1260-EDIT-US-PHONE-NUM\n              THRU 1260-EDIT-US-PHONE-NUM-EXIT\n           MOVE WS-EDIT-US-PHONE-NUM-FLGS\n                                         TO WS-EDIT-PHONE-NUM-2-FLGS\n\n           MOVE 'EFT Account Id'         TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                         TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 10                       TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EFT-ACCOUNT-ID-FLGS\n\n           MOVE 'Primary Card Holder'    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND\n                                         TO WS-EDIT-YES-NO\n           PERFORM 1220-EDIT-YESNO\n              THRU 1220-EDIT-YESNO-EXIT\n           MOVE WS-EDIT-YES-NO           TO WS-EDIT-PRI-CARDHOLDER\n\n      *    Cross field edits begin here\n           IF  FLG-STATE-ISVALID\n           AND FLG-ZIPCODE-ISVALID\n               PERFORM 1280-EDIT-US-STATE-ZIP-CD\n                  THRU 1280-EDIT-US-STATE-ZIP-CD-EXIT\n           END-IF\n\n           IF INPUT-ERROR\n              CONTINUE\n           ELSE\n              SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE\n           END-IF\n           .\n\n",
        "paragraph_lines": [1420, 1667],
        "ref_paragraphs": [
          "1210-EDIT-ACCOUNT",
          "1210-EDIT-ACCOUNT-EXIT",
          "1205-COMPARE-OLD-NEW",
          "1205-COMPARE-OLD-NEW-EXIT",
          "1220-EDIT-YESNO",
          "1220-EDIT-YESNO-EXIT",
          "EDIT-DATE-CCYYMMDD",
          "EDIT-DATE-CCYYMMDD-EXIT",
          "1250-EDIT-SIGNED-9V2",
          "1250-EDIT-SIGNED-9V2-EXIT",
          "EDIT-DATE-CCYYMMDD",
          "EDIT-DATE-CCYYMMDD-EXIT",
          "1250-EDIT-SIGNED-9V2",
          "1250-EDIT-SIGNED-9V2-EXIT",
          "EDIT-DATE-CCYYMMDD",
          "EDIT-DATE-CCYYMMDD-EXIT",
          "1250-EDIT-SIGNED-9V2",
          "1250-EDIT-SIGNED-9V2-EXIT",
          "1250-EDIT-SIGNED-9V2",
          "1250-EDIT-SIGNED-9V2-EXIT",
          "1250-EDIT-SIGNED-9V2",
          "1250-EDIT-SIGNED-9V2-EXIT",
          "1265-EDIT-US-SSN",
          "1265-EDIT-US-SSN-EXIT",
          "EDIT-DATE-CCYYMMDD",
          "EDIT-DATE-CCYYMMDD-EXIT",
          "EDIT-DATE-OF-BIRTH",
          "EDIT-DATE-OF-BIRTH-EXIT",
          "1245-EDIT-NUM-REQD",
          "1245-EDIT-NUM-REQD-EXIT",
          "1275-EDIT-FICO-SCORE",
          "1275-EDIT-FICO-SCORE-EXIT",
          "1225-EDIT-ALPHA-REQD",
          "1225-EDIT-ALPHA-REQD-EXIT",
          "1235-EDIT-ALPHA-OPT",
          "1235-EDIT-ALPHA-OPT-EXIT",
          "1225-EDIT-ALPHA-REQD",
          "1225-EDIT-ALPHA-REQD-EXIT",
          "1215-EDIT-MANDATORY",
          "1215-EDIT-MANDATORY-EXIT",
          "1225-EDIT-ALPHA-REQD",
          "1225-EDIT-ALPHA-REQD-EXIT",
          "1270-EDIT-US-STATE-CD",
          "1270-EDIT-US-STATE-CD-EXIT",
          "1245-EDIT-NUM-REQD",
          "1245-EDIT-NUM-REQD-EXIT",
          "1225-EDIT-ALPHA-REQD",
          "1225-EDIT-ALPHA-REQD-EXIT",
          "1225-EDIT-ALPHA-REQD",
          "1225-EDIT-ALPHA-REQD-EXIT",
          "1260-EDIT-US-PHONE-NUM",
          "1260-EDIT-US-PHONE-NUM-EXIT",
          "1260-EDIT-US-PHONE-NUM",
          "1260-EDIT-US-PHONE-NUM-EXIT",
          "1245-EDIT-NUM-REQD",
          "1245-EDIT-NUM-REQD-EXIT",
          "1220-EDIT-YESNO",
          "1220-EDIT-YESNO-EXIT",
          "1280-EDIT-US-STATE-ZIP-CD",
          "1280-EDIT-US-STATE-ZIP-CD-EXIT"
        ],
        "paragraph_logic": [
          "Calls the [account editing process]<1210-EDIT-ACCOUNT> to validate search keys and set initial account data.",
          "Calls the [account comparison process]<1205-COMPARE-OLD-NEW> to compare old and new account data.",
          "Calls the [yes/no editing process]<1220-EDIT-YESNO> to process various yes/no fields for editing the account status, primary card holder, etc.",
          "Calls the [date editing process]<EDIT-DATE-CCYYMMDD> to validate dates like open date, expiry date, reissue date, date of birth, etc.",
          "Calls the [signed number editing process]<1250-EDIT-SIGNED-9V2> for validating and editing numerical fields like credit limit, balance, etc.",
          "Calls the [name and address validation process]<1225-EDIT-ALPHA-REQD> and <1215-EDIT-MANDATORY> to validate fields such as first name, last name, state, zip code, etc."
        ]
      },
      "1200-EDIT-MAP-INPUTS-EXIT": {
        "paragraph_name": "1200-EDIT-MAP-INPUTS-EXIT",
        "section": "procedure division",
        "paragraph_code": "1200-EDIT-MAP-INPUTS-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [1669, 1671],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the end of the paragraph execution and returns control to the calling paragraph."
        ]
      },
      "1205-COMPARE-OLD-NEW": {
        "paragraph_name": "1205-COMPARE-OLD-NEW",
        "section": "procedure division",
        "paragraph_code": "1205-COMPARE-OLD-NEW.\n           SET NO-CHANGES-FOUND           TO TRUE\n\n           IF  ACUP-NEW-ACCT-ID-X         = ACUP-OLD-ACCT-ID-X\n           AND FUNCTION UPPER-CASE (\n               ACUP-NEW-ACTIVE-STATUS)    =\n               FUNCTION UPPER-CASE (\n               ACUP-OLD-ACTIVE-STATUS)\n           AND ACUP-NEW-CURR-BAL          = ACUP-OLD-CURR-BAL\n           AND ACUP-NEW-CREDIT-LIMIT      = ACUP-OLD-CREDIT-LIMIT\n           AND ACUP-NEW-CASH-CREDIT-LIMIT = ACUP-OLD-CASH-CREDIT-LIMIT\n           AND ACUP-NEW-OPEN-DATE         = ACUP-OLD-OPEN-DATE\n           AND ACUP-NEW-EXPIRAION-DATE    = ACUP-OLD-EXPIRAION-DATE\n           AND ACUP-NEW-REISSUE-DATE      = ACUP-OLD-REISSUE-DATE\n           AND ACUP-NEW-CURR-CYC-CREDIT   = ACUP-OLD-CURR-CYC-CREDIT\n           AND ACUP-NEW-CURR-CYC-DEBIT    = ACUP-OLD-CURR-CYC-DEBIT\n           AND FUNCTION UPPER-CASE (ACUP-NEW-GROUP-ID) =\n               FUNCTION UPPER-CASE (ACUP-OLD-GROUP-ID)\n               CONTINUE\n           ELSE\n               SET CHANGE-HAS-OCCURRED   TO TRUE\n               GO TO 1205-COMPARE-OLD-NEW-EXIT\n           END-IF\n\n\n           IF  FUNCTION UPPER-CASE (ACUP-NEW-CUST-ID-X)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ID-X)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-FIRST-NAME)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-FIRST-NAME)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-MIDDLE-NAME)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-MIDDLE-NAME)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-LAST-NAME)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-LAST-NAME)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-ADDR-LINE-1)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-1)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-ADDR-LINE-2)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-2)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-ADDR-LINE-3)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-3)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-ADDR-STATE-CD)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-STATE-CD)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-ADDR-COUNTRY-CD)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-COUNTRY-CD)\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-ADDR-ZIP)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-ZIP)\n           AND ACUP-NEW-CUST-PHONE-NUM-1A = ACUP-OLD-CUST-PHONE-NUM-1A\n           AND ACUP-NEW-CUST-PHONE-NUM-1B = ACUP-OLD-CUST-PHONE-NUM-1B\n           AND ACUP-NEW-CUST-PHONE-NUM-1C = ACUP-OLD-CUST-PHONE-NUM-1C\n           AND ACUP-NEW-CUST-PHONE-NUM-2A = ACUP-OLD-CUST-PHONE-NUM-2A\n           AND ACUP-NEW-CUST-PHONE-NUM-2B = ACUP-OLD-CUST-PHONE-NUM-2B\n           AND ACUP-NEW-CUST-PHONE-NUM-2C = ACUP-OLD-CUST-PHONE-NUM-2C\n           AND ACUP-NEW-CUST-SSN-X       = ACUP-OLD-CUST-SSN-X\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-GOVT-ISSUED-ID)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-GOVT-ISSUED-ID)\n           AND ACUP-NEW-CUST-DOB-YYYY-MM-DD\n                                     = ACUP-OLD-CUST-DOB-YYYY-MM-DD\n           AND ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                     = ACUP-OLD-CUST-EFT-ACCOUNT-ID\n           AND FUNCTION UPPER-CASE (ACUP-NEW-CUST-PRI-HOLDER-IND)=\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-PRI-HOLDER-IND)\n           AND ACUP-NEW-CUST-FICO-SCORE-X\n                                     = ACUP-OLD-CUST-FICO-SCORE-X\n               SET NO-CHANGES-DETECTED   TO TRUE\n           ELSE\n               SET CHANGE-HAS-OCCURRED   TO TRUE\n               GO TO 1205-COMPARE-OLD-NEW-EXIT\n           END-IF\n\n           .\n\n",
        "paragraph_lines": [1672, 1740],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Initializes the comparison state by setting NO-CHANGES-FOUND to true.",
          "Compares each pair of old and new account attributes. If all match, continues; else, sets CHANGE-HAS-OCCURRED to true and exits.",
          "Compares each pair of old and new customer information. If all match, sets NO-CHANGES-DETECTED to true; else, sets CHANGE-HAS-OCCURRED to true and exits."
        ]
      },
      "1205-COMPARE-OLD-NEW-EXIT": {
        "paragraph_name": "1205-COMPARE-OLD-NEW-EXIT",
        "section": "procedure division",
        "paragraph_code": "1205-COMPARE-OLD-NEW-EXIT.\n           EXIT\n           .\n\n\n",
        "paragraph_lines": [1742, 1744],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the [compare old and new process]<1205-COMPARE-OLD-NEW-EXIT> without performing any additional logic."
        ]
      },
      "1210-EDIT-ACCOUNT": {
        "paragraph_name": "1210-EDIT-ACCOUNT",
        "section": "procedure division",
        "paragraph_code": "1210-EDIT-ACCOUNT.\n           SET FLG-ACCTFILTER-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF CC-ACCT-ID   EQUAL LOW-VALUES\n           OR CC-ACCT-ID   EQUAL SPACES\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ACCTFILTER-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 SET WS-PROMPT-FOR-ACCT TO TRUE\n              END-IF\n              MOVE ZEROES               TO CDEMO-ACCT-ID\n                                           ACUP-NEW-ACCT-ID\n              GO TO  1210-EDIT-ACCOUNT-EXIT\n           END-IF\n\n      *    Not numeric\n      *    Not 11 characters\n           MOVE CC-ACCT-ID              TO ACUP-NEW-ACCT-ID\n           IF CC-ACCT-ID   IS NOT NUMERIC\n           OR CC-ACCT-ID-N EQUAL ZEROS\n              SET INPUT-ERROR TO TRUE\n              IF WS-RETURN-MSG-OFF\n                STRING\n                 'Account Number if supplied must be a 11 digit'\n                 ' Non-Zero Number'\n                DELIMITED BY SIZE\n                INTO WS-RETURN-MSG\n              END-IF\n              MOVE ZEROES               TO CDEMO-ACCT-ID\n              GO TO 1210-EDIT-ACCOUNT-EXIT\n           ELSE\n              MOVE CC-ACCT-ID TO CDEMO-ACCT-ID\n              SET FLG-ACCTFILTER-ISVALID TO TRUE\n           END-IF\n           .\n\n",
        "paragraph_lines": [1748, 1783],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Sets the account filter flag to not-OK<FLG-ACCTFILTER-NOT-OK>.",
          "Checks if the account ID is empty or has low values and sets appropriate error flags<FLG-ACCTFILTER-BLANK>.",
          "Initializes the account ID and prompts for account input if no account ID is provided<WS-PROMPT-FOR-ACCT>.",
          "Validates if the account ID is numeric and exactly 11 characters long, sets input error if not<WS-RETURN-MSG>.",
          "Moves the account ID to appropriate fields if valid and sets the account filter flag to valid<FLG-ACCTFILTER-ISVALID>."
        ]
      },
      "1210-EDIT-ACCOUNT-EXIT": {
        "paragraph_name": "1210-EDIT-ACCOUNT-EXIT",
        "section": "procedure division",
        "paragraph_code": "1210-EDIT-ACCOUNT-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [1785, 1787],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the 1210-EDIT-ACCOUNT-EXIT paragraph, effectively ending its execution flow."
        ]
      },
      "1215-EDIT-MANDATORY": {
        "paragraph_name": "1215-EDIT-MANDATORY",
        "section": "procedure division",
        "paragraph_code": "1215-EDIT-MANDATORY.\n      *    Initialize\n           SET FLG-MANDATORY-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                       EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                       EQUAL SPACES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n\n              SET INPUT-ERROR          TO TRUE\n              SET FLG-MANDATORY-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1215-EDIT-MANDATORY-EXIT\n           END-IF\n\n           SET FLG-MANDATORY-ISVALID   TO TRUE\n           .\n",
        "paragraph_lines": [1789, 1815],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Initializes the mandatory field flag to indicate it is not yet okay.",
          "Checks if the alphanumeric input field is either empty or contains only low-values or spaces.",
          "If the input field is empty or all spaces, sets an input error flag and marks the mandatory field as blank.",
          "If the return message option is off, constructs an error message indicating that the mandatory field must be supplied.",
          "Exits the mandatory field edit process if an error is found.",
          "If the input field is valid, sets the flag to indicate the mandatory field is valid."
        ]
      },
      "1215-EDIT-MANDATORY-EXIT": {
        "paragraph_name": "1215-EDIT-MANDATORY-EXIT",
        "section": "procedure division",
        "paragraph_code": "1215-EDIT-MANDATORY-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [1816, 1818],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the end of the paragraph [1215-EDIT-MANDATORY-EXIT] and exits the routine."
        ]
      },
      "1220-EDIT-YESNO": {
        "paragraph_name": "1220-EDIT-YESNO",
        "section": "procedure division",
        "paragraph_code": "1220-EDIT-YESNO.\n      *    Must be Y or N\n      *    SET FLG-YES-NO-NOT-OK         TO TRUE\n      *\n      *    Not supplied\n           IF WS-EDIT-YES-NO             EQUAL LOW-VALUES\n           OR WS-EDIT-YES-NO             EQUAL SPACES\n           OR WS-EDIT-YES-NO             EQUAL ZEROS\n              SET INPUT-ERROR            TO TRUE\n              SET FLG-YES-NO-BLANK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1220-EDIT-YESNO-EXIT\n           END-IF\n\n\n           IF FLG-YES-NO-ISVALID\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR             TO TRUE\n              SET FLG-YES-NO-NOT-OK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must be Y or N.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1220-EDIT-YESNO-EXIT\n           END-IF\n           .\n",
        "paragraph_lines": [1820, 1857],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Checks if the input value for a Yes/No field is not supplied, set input error flag and appropriate message.",
          "Ensures that the input value for a Yes/No field is either Y or N.",
          "Sets the input error flag and creates an error message if the value is neither Y nor N.",
          "Strings together the variable name and a message indicating that the value must be supplied, if not already provided.",
          "Handles the appropriate exit logic based on whether the Yes/No value is valid or not."
        ]
      },
      "1220-EDIT-YESNO-EXIT": {
        "paragraph_name": "1220-EDIT-YESNO-EXIT",
        "section": "procedure division",
        "paragraph_code": "1220-EDIT-YESNO-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [1858, 1860],
        "ref_paragraphs": [],
        "paragraph_logic": ["Exits the current paragraph, marking the end of 1220-EDIT-YESNO-EXIT."]
      },
      "1225-EDIT-ALPHA-REQD": {
        "paragraph_name": "1225-EDIT-ALPHA-REQD",
        "section": "procedure division",
        "paragraph_code": "1225-EDIT-ALPHA-REQD.\n      *    Initialize\n           SET FLG-ALPHA-NOT-OK              TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHA-BLANK            TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1225-EDIT-ALPHA-REQD-EXIT\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHA-FROM-X   TO LIT-ALL-ALPHA-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHA-FROM\n                     TO LIT-ALPHA-SPACES-TO\n\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHA-NOT-OK      TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' can have alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1225-EDIT-ALPHA-REQD-EXIT\n           END-IF\n\n           SET FLG-ALPHA-ISVALID        TO TRUE\n           .\n",
        "paragraph_lines": [1862, 1910],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Initializes the [alpha validation flag] by setting FLG-ALPHA-NOT-OK to TRUE.",
          "Checks if the input field is not supplied (equals LOW-VALUES or SPACES) and sets appropriate error flags.",
          "If input is missing, constructs an error message indicating the field must be supplied and exits.",
          "Prepares the input field for validation by converting specified characters to spaces, allowing only alphabets and spaces.",
          "If the input contains invalid characters, sets error flags and constructs an appropriate error message before exiting.",
          "If all validations pass, sets the alpha validation flag FLG-ALPHA-ISVALID to TRUE."
        ]
      },
      "1225-EDIT-ALPHA-REQD-EXIT": {
        "paragraph_name": "1225-EDIT-ALPHA-REQD-EXIT",
        "section": "procedure division",
        "paragraph_code": "1225-EDIT-ALPHA-REQD-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [1911, 1913],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits from the [alpha required field edit process]<1225-EDIT-ALPHA-REQD-EXIT> after completing the necessary edits and validations."
        ]
      },
      "1230-EDIT-ALPHANUM-REQD": {
        "paragraph_name": "1230-EDIT-ALPHANUM-REQD",
        "section": "procedure division",
        "paragraph_code": "1230-EDIT-ALPHANUM-REQD.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHNANUM-BLANK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1230-EDIT-ALPHANUM-REQD-EXIT\n           END-IF\n\n      *    Only Alphabets,numbers and space allowed\n           MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM\n\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHANUM-FROM\n                     TO LIT-ALPHANUM-SPACES-TO\n\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' can have numbers or alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1230-EDIT-ALPHANUM-REQD-EXIT\n           END-IF\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n",
        "paragraph_lines": [1915, 1964],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Checks if the alphanumeric field is not provided by comparing it to low-values or spaces.",
          "If the field is empty, sets the input error flags and constructs an appropriate error message if messages are enabled.",
          "Converts allowed alphanumeric characters and spaces for validation purposes.",
          "If the conversion results in any non-space characters, sets the error flags and constructs an error message.",
          "Sets alphanumeric validity flag to true if the field passes all checks."
        ]
      },
      "1230-EDIT-ALPHANUM-REQD-EXIT": {
        "paragraph_name": "1230-EDIT-ALPHANUM-REQD-EXIT",
        "section": "procedure division",
        "paragraph_code": "1230-EDIT-ALPHANUM-REQD-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [1965, 1967],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the current paragraph process.",
          "No additional processing steps or calls to other paragraphs."
        ]
      },
      "1235-EDIT-ALPHA-OPT": {
        "paragraph_name": "1235-EDIT-ALPHA-OPT",
        "section": "procedure division",
        "paragraph_code": "1235-EDIT-ALPHA-OPT.\n      *    Initialize\n           SET FLG-ALPHA-NOT-OK              TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n\n              SET FLG-ALPHA-ISVALID          TO TRUE\n              GO TO  1235-EDIT-ALPHA-OPT-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHA-FROM-X    TO LIT-ALL-ALPHA-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHA-FROM\n                     TO LIT-ALPHA-SPACES-TO\n\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHA-NOT-OK      TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' can have alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1235-EDIT-ALPHA-OPT-EXIT\n           END-IF\n\n           SET FLG-ALPHA-ISVALID        TO TRUE\n           .\n",
        "paragraph_lines": [1968, 2008],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Initializes the alpha validation process by setting the alpha-not-ok flag to true.",
          "Checks if the input string is not supplied by comparing it against low values and spaces; sets the alpha-valid flag to true if empty and exits.",
          "Converts the input string to ensure that only alphabets and spaces are allowed, by inspecting and converting the characters.",
          "If the converted string still contains invalid characters, sets the input error and alpha-not-ok flags, constructs an error message if needed, and exits.",
          "If the string is valid, sets the alpha-valid flag to true."
        ]
      },
      "1235-EDIT-ALPHA-OPT-EXIT": {
        "paragraph_name": "1235-EDIT-ALPHA-OPT-EXIT",
        "section": "procedure division",
        "paragraph_code": "1235-EDIT-ALPHA-OPT-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2009, 2011],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the end of the paragraph and exits, returning control to the calling paragraph."
        ]
      },
      "1240-EDIT-ALPHANUM-OPT": {
        "paragraph_name": "1240-EDIT-ALPHANUM-OPT",
        "section": "procedure division",
        "paragraph_code": "1240-EDIT-ALPHANUM-OPT.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied, but ok as optional\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n              SET FLG-ALPHNANUM-ISVALID     TO TRUE\n              GO TO  1240-EDIT-ALPHANUM-OPT-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      *    Only Alphabets and space allowed\n           MOVE LIT-ALL-ALPHANUM-FROM-X TO LIT-ALL-ALPHANUM-FROM\n           INSPECT WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n             CONVERTING LIT-ALL-ALPHANUM-FROM\n                     TO LIT-ALPHANUM-SPACES-TO\n\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' can have numbers or alphabets only.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1240-EDIT-ALPHANUM-OPT-EXIT\n           END-IF\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n",
        "paragraph_lines": [2013, 2052],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Sets the [FLAG for alphanumeric check status] to indicate the validation process has started as it is initially not valid.",
          "Checks if the alphanumeric input is [either low-values or spaces] to determine if the input is optional and should be passed as valid.",
          "If the input is optional, it sets the [FLAG for alphanumeric validation] to true and exits the paragraph.",
          "Moves and inspects the alphanumeric input to [convert all non-alphanumeric characters] to spaces for further validation.",
          "If the input contains only spaces, continues without an error; otherwise, it [sets the input error flag] and prepares an error message if needed.",
          "Finally, sets the [FLAG for alphanumeric validation] to true to indicate the input is valid."
        ]
      },
      "1240-EDIT-ALPHANUM-OPT-EXIT": {
        "paragraph_name": "1240-EDIT-ALPHANUM-OPT-EXIT",
        "section": "procedure division",
        "paragraph_code": "1240-EDIT-ALPHANUM-OPT-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2053, 2055],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the paragraph, ending the current processing and returning control to the calling statement."
        ]
      },
      "1245-EDIT-NUM-REQD": {
        "paragraph_name": "1245-EDIT-NUM-REQD",
        "section": "procedure division",
        "paragraph_code": "1245-EDIT-NUM-REQD.\n      *    Initialize\n           SET FLG-ALPHNANUM-NOT-OK          TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                                             EQUAL LOW-VALUES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n               EQUAL SPACES\n           OR WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH) = SPACE\n\n              SET INPUT-ERROR                TO TRUE\n              SET FLG-ALPHNANUM-BLANK        TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           END-IF\n\n      *    Only all numeric allowed\n\n           IF WS-EDIT-ALPHANUM-ONLY(1:WS-EDIT-ALPHANUM-LENGTH)\n                  IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must be all numeric.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           END-IF\n\n      *    Must not be zero\n\n           IF FUNCTION NUMVAL(WS-EDIT-ALPHANUM-ONLY(1:\n                              WS-EDIT-ALPHANUM-LENGTH)) = 0\n              SET INPUT-ERROR           TO TRUE\n              SET FLG-ALPHNANUM-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must not be zero.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1245-EDIT-NUM-REQD-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n\n           SET FLG-ALPHNANUM-ISVALID    TO TRUE\n           .\n",
        "paragraph_lines": [2057, 2122],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Initializes the error flag to indicate invalid alphanumeric input.",
          "Checks if the alphanumeric input is empty; if true, sets input error flags and constructs a must be supplied error message.",
          "Examines whether the input consists solely of numeric characters; if false, flags an input error and constructs a must be all numeric error message.",
          "Validates that the numeric input is not zero; if zero, sets the input error flag and constructs a must not be zero error message.",
          "Sets the alphanumeric validation flag to indicate valid input if no errors are detected."
        ]
      },
      "1245-EDIT-NUM-REQD-EXIT": {
        "paragraph_name": "1245-EDIT-NUM-REQD-EXIT",
        "section": "procedure division",
        "paragraph_code": "1245-EDIT-NUM-REQD-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2123, 2125],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the paragraph, indicating the end of the routine.<1245-EDIT-NUM-REQD-EXIT>"
        ]
      },
      "1250-EDIT-SIGNED-9V2": {
        "paragraph_name": "1250-EDIT-SIGNED-9V2",
        "section": "procedure division",
        "paragraph_code": "1250-EDIT-SIGNED-9V2.\n           SET FLG-SIGNED-NUMBER-NOT-OK    TO TRUE\n\n      *    Not supplied\n           IF WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL LOW-VALUES\n           OR WS-EDIT-SIGNED-NUMBER-9V2-X  EQUAL SPACES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-SIGNED-NUMBER-BLANK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1250-EDIT-SIGNED-9V2-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF WS-EDIT-SIGNED-NUMBER-9V2-X IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR             TO TRUE\n              SET FLG-SIGNED-NUMBER-NOT-OK   TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ' is not valid'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n              END-IF\n              GO TO  1250-EDIT-SIGNED-9V2-EXIT\n\n           END-IF\n\n      *    If we got here all edits were cleared\n           SET FLG-SIGNED-NUMBER-ISVALID  TO TRUE\n           .\n\n",
        "paragraph_lines": [2127, 2166],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Sets the flag indicating that the signed number is not okay initially.",
          "Checks if the signed number field is either low-values or blank and sets error flags accordingly.",
          "If the return message indicator is off, constructs an appropriate message indicating that the field must be supplied.",
          "Verifies if the signed number field contains numeric data, and if not, sets the relevant error flags and constructs an error message indicating invalid data.",
          "If all checks pass, sets the flag indicating the signed number is valid."
        ]
      },
      "1250-EDIT-SIGNED-9V2-EXIT": {
        "paragraph_name": "1250-EDIT-SIGNED-9V2-EXIT",
        "section": "procedure division",
        "paragraph_code": "1250-EDIT-SIGNED-9V2-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2168, 2170],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Ends the execution of the paragraph and returns control to the calling paragraph."
        ]
      },
      "1260-EDIT-US-PHONE-NUM": {
        "paragraph_name": "1260-EDIT-US-PHONE-NUM",
        "section": "procedure division",
        "paragraph_code": "1260-EDIT-US-PHONE-NUM.\n\n      *    The database stores date in X(15) format (999)999-9999\n      *                                             1234567890123\n      *    So we take the X(15) input into WS-EDIT-US-PHONE-NUM\n      *    and edit it\n\n           SET WS-EDIT-US-PHONE-IS-INVALID TO TRUE\n      *    Not mandatory to enter a phone number\n           IF  (WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES)\n           AND (WS-EDIT-US-PHONE-NUMB EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES)\n           AND (WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR   WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES)\n                SET WS-EDIT-US-PHONE-IS-VALID TO TRUE\n                GO TO EDIT-US-PHONE-EXIT\n           ELSE\n                CONTINUE\n           END-IF\n           .\n",
        "paragraph_lines": [2172, 2192],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Sets the initial status of the phone number as invalid for validation purposes.",
          "Checks if the phone number fields are either empty or contain low-values.",
          "If all fields are either empty or contain low-values, marks the phone number as valid.",
          "If any of the fields are not empty or do not contain low-values, the process continues without marking the phone number as valid.",
          "Exits the phone number editing process if the phone number is validated successfully."
        ]
      },
      "EDIT-AREA-CODE": {
        "paragraph_name": "EDIT-AREA-CODE",
        "section": "procedure division",
        "paragraph_code": "EDIT-AREA-CODE.\n           IF WS-EDIT-US-PHONE-NUMA EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMA EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEA-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Area code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMA       IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Area code must be A 3 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMA-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Area code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           ELSE\n              CONTINUE\n           END-IF\n\n           MOVE WS-EDIT-US-PHONE-NUMA\n             TO WS-US-PHONE-AREA-CODE-TO-EDIT\n           IF VALID-GENERAL-PURP-CODE\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEA-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Not valid North America general purpose area code'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-PREFIX\n           END-IF\n\n           SET FLG-EDIT-US-PHONEA-ISVALID    TO TRUE\n           .\n",
        "paragraph_lines": [2193, 2262],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Checks if the area code is either blank or contains low values; if true, marks an input error and updates the error flags and messages.",
          "Verifies if the area code consists of numeric values; if its non-numeric, marks an input error, updates the error flags, and sets the appropriate message.",
          "Tests whether the area code is zero; if zero, marks an input error, updates the error flags and sets the error message.",
          "Assigns the validated area code to the working storage variable for further processing.",
          "Confirms if the area code is a valid general-purpose code; if not valid, marks an input error, updates the error flags, and sets the applicable message.",
          "Sets the valid flag to indicate the area code is valid if no errors are encountered."
        ]
      },
      "EDIT-US-PHONE-PREFIX": {
        "paragraph_name": "EDIT-US-PHONE-PREFIX",
        "section": "procedure division",
        "paragraph_code": "EDIT-US-PHONE-PREFIX.\n\n           IF WS-EDIT-US-PHONE-NUMB EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMB EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEB-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Prefix code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMB          IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Prefix code must be A 3 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMB-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEB-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Prefix code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-LINENUM\n           ELSE\n              CONTINUE\n           END-IF\n\n           SET FLG-EDIT-US-PHONEB-ISVALID    TO TRUE\n           .\n\n",
        "paragraph_lines": [2263, 2315],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Checks if the US phone prefix is either blank or contains low values and sets input error flags if true. Constructs an error message for blank or low-value prefix and sets it in WS-RETURN-MSG.",
          "Checks if the US phone prefix is numeric, sets input error flags if not. Constructs an error message for non-numeric prefix and sets it in WS-RETURN-MSG.",
          "Checks if the US phone prefix value is zero and sets input error flags if true. Constructs an error message for zero prefix and sets it in WS-RETURN-MSG.",
          "Sets flag indicating the phone prefix is valid after all checks are passed."
        ]
      },
      "EDIT-US-PHONE-LINENUM": {
        "paragraph_name": "EDIT-US-PHONE-LINENUM",
        "section": "procedure division",
        "paragraph_code": "EDIT-US-PHONE-LINENUM.\n           IF WS-EDIT-US-PHONE-NUMC EQUAL SPACES\n           OR WS-EDIT-US-PHONE-NUMC EQUAL LOW-VALUES\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-EDIT-US-PHONEC-BLANK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Line number code must be supplied.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO EDIT-US-PHONE-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMC          IS NUMERIC\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                 TO TRUE\n              SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Line number code must be A 4 digit number.'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-EXIT\n           END-IF\n\n           IF  WS-EDIT-US-PHONE-NUMC-N = 0\n              SET INPUT-ERROR              TO TRUE\n              SET  FLG-EDIT-US-PHONEC-NOT-OK  TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': Line number code cannot be zero'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  EDIT-US-PHONE-EXIT\n           ELSE\n               CONTINUE\n           END-IF\n\n\n           SET FLG-EDIT-US-PHONEC-ISVALID    TO TRUE\n           .\n\n",
        "paragraph_lines": [2317, 2369],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Checks if the US phone line number is either spaces or low-values; if so, sets input error and triggers an appropriate error message.",
          "Validates whether the phone line number is numeric; if not, sets input error and triggers an error message indicating it must be a 4-digit number.",
          "Checks if the phone line number is zero; if so, sets input error and triggers an error message indicating it cannot be zero.",
          "If no errors are found, sets the flag indicating the phone line number is valid.",
          "Proceeds to EDIT-US-PHONE-EXIT if any input errors are encountered."
        ]
      },
      "EDIT-US-PHONE-EXIT": {
        "paragraph_name": "EDIT-US-PHONE-EXIT",
        "section": "procedure division",
        "paragraph_code": "EDIT-US-PHONE-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [2371, 2373],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the EDIT-US-PHONE process, signaling the end of the editing or validation routine for a US phone number."
        ]
      },
      "1260-EDIT-US-PHONE-NUM-EXIT": {
        "paragraph_name": "1260-EDIT-US-PHONE-NUM-EXIT",
        "section": "procedure division",
        "paragraph_code": "1260-EDIT-US-PHONE-NUM-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2374, 2376],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the end of the US phone number editing logic and exits the routine."
        ]
      },
      "1265-EDIT-US-SSN": {
        "paragraph_name": "1265-EDIT-US-SSN",
        "section": "procedure division",
        "paragraph_code": "1265-EDIT-US-SSN.\n      *Format xxx-xx-xxxx\n      *Part1 :should have 3 digits\n      *Part2 :should have 2 digits and it should be from 01 to 99\n      *Part3 should have 4 digits from 0001 to 9999.\n      ******************************************************************\n      *    Edit SSN Part 1\n      ******************************************************************\n           MOVE 'SSN: First 3 chars'     TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-1      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 3                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART1-FLGS\n\n      *Part1 :should not be 000, 666, or between 900 and 999\n           IF FLG-EDIT-US-SSN-PART1-ISVALID\n              MOVE ACUP-NEW-CUST-SSN-1   TO WS-EDIT-US-SSN-PART1\n              IF INVALID-SSN-PART1\n              SET INPUT-ERROR            TO TRUE\n              SET FLG-EDIT-US-SSN-PART1-NOT-OK\n                                 TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': should not be 000, 666, or between 900 and 999'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              ELSE\n                CONTINUE\n              END-IF\n           END-IF\n\n      ******************************************************************\n      *    Edit SSN Part 2\n      ******************************************************************\n           MOVE 'SSN 4th & 5th chars'    TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-2      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 2                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART2-FLGS\n\n\n      ******************************************************************\n      *    Edit SSN Part 3\n      ******************************************************************\n           MOVE 'SSN Last 4 chars'       TO WS-EDIT-VARIABLE-NAME\n           MOVE ACUP-NEW-CUST-SSN-3      TO WS-EDIT-ALPHANUM-ONLY\n           MOVE 4                        TO WS-EDIT-ALPHANUM-LENGTH\n           PERFORM 1245-EDIT-NUM-REQD\n              THRU 1245-EDIT-NUM-REQD-EXIT\n           MOVE WS-EDIT-ALPHANUM-ONLY-FLAGS\n                                         TO WS-EDIT-US-SSN-PART3-FLGS\n           .\n",
        "paragraph_lines": [2378, 2435],
        "ref_paragraphs": [
          "1245-EDIT-NUM-REQD",
          "1245-EDIT-NUM-REQD-EXIT",
          "1245-EDIT-NUM-REQD",
          "1245-EDIT-NUM-REQD-EXIT",
          "1245-EDIT-NUM-REQD",
          "1245-EDIT-NUM-REQD-EXIT"
        ],
        "paragraph_logic": [
          "Checks and formats the first part of the SSN, ensuring it is three digits long and not invalid codes <1245-EDIT-NUM-REQD>.",
          "Verifies the first part of the SSN to ensure it is not 000, 666, or between 900 and 999.",
          "Processes the second part of the SSN to ensure it contains two digits and is between 01 to 99 <1245-EDIT-NUM-REQD>.",
          "Validates the second part of the SSN and prepares it for further processing.",
          "Formats and checks the third part of the SSN, ensuring it contains four digits from 0001 to 9999 <1245-EDIT-NUM-REQD>.",
          "Sets up the flags for the third part of the SSN after validation."
        ]
      },
      "1265-EDIT-US-SSN-EXIT": {
        "paragraph_name": "1265-EDIT-US-SSN-EXIT",
        "section": "procedure division",
        "paragraph_code": "1265-EDIT-US-SSN-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2436, 2438],
        "ref_paragraphs": [],
        "paragraph_logic": ["Terminates the [edit US SSN process]<1265-EDIT-US-SSN-EXIT>."]
      },
      "1270-EDIT-US-STATE-CD": {
        "paragraph_name": "1270-EDIT-US-STATE-CD",
        "section": "procedure division",
        "paragraph_code": "1270-EDIT-US-STATE-CD.\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD TO US-STATE-CODE-TO-EDIT\n           IF VALID-US-STATE-CODE\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-STATE-NOT-OK         TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': is not a valid state code'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1270-EDIT-US-STATE-CD-EXIT\n           END-IF\n           .\n",
        "paragraph_lines": [2440, 2457],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Moves the new customer address state code to the variable US-STATE-CODE-TO-EDIT.",
          "Checks if the state code is valid using VALID-US-STATE-CODE.",
          "If the state code is valid, the program continues without any action.",
          "If the state code is not valid, sets both INPUT-ERROR and FLG-STATE-NOT-OK to TRUE.",
          "If WS-RETURN-MSG-OFF is on, constructs an error message with the invalid state code information.",
          "Returns to the exit paragraph 1270-EDIT-US-STATE-CD-EXIT if the state code is invalid."
        ]
      },
      "1270-EDIT-US-STATE-CD-EXIT": {
        "paragraph_name": "1270-EDIT-US-STATE-CD-EXIT",
        "section": "procedure division",
        "paragraph_code": "1270-EDIT-US-STATE-CD-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [2458, 2460],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Terminates the EDIT-US-STATE-CD process and exits the paragraph, returning control to the calling paragraph."
        ]
      },
      "1275-EDIT-FICO-SCORE": {
        "paragraph_name": "1275-EDIT-FICO-SCORE",
        "section": "procedure division",
        "paragraph_code": "1275-EDIT-FICO-SCORE.\n           IF FICO-RANGE-IS-VALID\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-FICO-SCORE-NOT-OK    TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   WS-EDIT-VARIABLE-NAME\n                   ': should be between 300 and 850'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1275-EDIT-FICO-SCORE-EXIT\n           END-IF\n           .\n",
        "paragraph_lines": [2461, 2477],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Check if the FICO score is within the valid range (300 to 850); continue if valid.",
          "If the FICO score is invalid, set error flags [INPUT-ERROR and FLG-FICO-SCORE-NOT-OK] to TRUE.",
          "If WS-RETURN-MSG-OFF is set, construct an error message indicating the valid FICO score range.",
          "Store the constructed error message in WS-RETURN-MSG.",
          "Exit the FICO score editing process if an error is found."
        ]
      },
      "1275-EDIT-FICO-SCORE-EXIT": {
        "paragraph_name": "1275-EDIT-FICO-SCORE-EXIT",
        "section": "procedure division",
        "paragraph_code": "1275-EDIT-FICO-SCORE-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2478, 2480],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the 1275-EDIT-FICO-SCORE paragraph, marking the end of its execution."
        ]
      },
      "1280-EDIT-US-STATE-ZIP-CD": {
        "paragraph_name": "1280-EDIT-US-STATE-ZIP-CD",
        "section": "procedure division",
        "paragraph_code": "1280-EDIT-US-STATE-ZIP-CD.\n           STRING ACUP-NEW-CUST-ADDR-STATE-CD\n                  ACUP-NEW-CUST-ADDR-ZIP(1:2)\n             DELIMITED BY SIZE\n             INTO US-STATE-AND-FIRST-ZIP2\n\n           IF VALID-US-STATE-ZIP-CD2-COMBO\n               CONTINUE\n           ELSE\n              SET INPUT-ERROR              TO TRUE\n              SET FLG-STATE-NOT-OK         TO TRUE\n              SET FLG-ZIPCODE-NOT-OK       TO TRUE\n              IF WS-RETURN-MSG-OFF\n                 STRING\n                   'Invalid zip code for state'\n                   DELIMITED BY SIZE\n                   INTO WS-RETURN-MSG\n                 END-STRING\n              END-IF\n              GO TO  1280-EDIT-US-STATE-ZIP-CD-EXIT\n           END-IF\n           .\n",
        "paragraph_lines": [2483, 2504],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Combines the state code and the first two digits of the ZIP code into a single variable for validation.",
          "Checks if the combined state and ZIP code are valid. If valid, does nothing.",
          "If invalid, sets the INPUT-ERROR flag to TRUE, indicating an error in input.",
          "Sets both FLG-STATE-NOT-OK and FLG-ZIPCODE-NOT-OK to TRUE, highlighting the invalid state and ZIP code.",
          "If the return message flag is off, produces an error message Invalid zip code for state and stores it in WS-RETURN-MSG."
        ]
      },
      "1280-EDIT-US-STATE-ZIP-CD-EXIT": {
        "paragraph_name": "1280-EDIT-US-STATE-ZIP-CD-EXIT",
        "section": "procedure division",
        "paragraph_code": "1280-EDIT-US-STATE-ZIP-CD-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2505, 2507],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the current paragraph, ending the editing process for the US state ZIP code."
        ]
      },
      "2000-DECIDE-ACTION": {
        "paragraph_name": "2000-DECIDE-ACTION",
        "section": "procedure division",
        "paragraph_code": "2000-DECIDE-ACTION.\n           EVALUATE TRUE\n      ******************************************************************\n      *       NO DETAILS SHOWN.\n      *       SO GET THEM AND SETUP DETAIL EDIT SCREEN\n      ******************************************************************\n              WHEN ACUP-DETAILS-NOT-FETCHED\n      ******************************************************************\n      *       CHANGES MADE. BUT USER CANCELS\n      ******************************************************************\n              WHEN CCARD-AID-PFK12\n                 IF  FLG-ACCTFILTER-ISVALID\n                     SET WS-RETURN-MSG-OFF       TO TRUE\n                     PERFORM 9000-READ-ACCT\n                        THRU 9000-READ-ACCT-EXIT\n                     IF FOUND-CUST-IN-MASTER\n                        SET ACUP-SHOW-DETAILS    TO TRUE\n                     END-IF\n                 END-IF\n      ******************************************************************\n      *       DETAILS SHOWN\n      *       CHECK CHANGES AND ASK CONFIRMATION IF GOOD\n      ******************************************************************\n              WHEN ACUP-SHOW-DETAILS\n                 IF INPUT-ERROR\n                 OR NO-CHANGES-DETECTED\n                    CONTINUE\n                 ELSE\n                    SET ACUP-CHANGES-OK-NOT-CONFIRMED TO TRUE\n                 END-IF\n      ******************************************************************\n      *       DETAILS SHOWN\n      *       BUT INPUT EDIT ERRORS FOUND\n      ******************************************************************\n              WHEN ACUP-CHANGES-NOT-OK\n                  CONTINUE\n      ******************************************************************\n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED\n      *       CONFIRMATION GIVEN.SO SAVE THE CHANGES\n      ******************************************************************\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n               AND CCARD-AID-PFK05\n                 PERFORM 9600-WRITE-PROCESSING\n                    THRU 9600-WRITE-PROCESSING-EXIT\n                 EVALUATE TRUE\n                    WHEN COULD-NOT-LOCK-ACCT-FOR-UPDATE\n                         SET ACUP-CHANGES-OKAYED-LOCK-ERROR TO TRUE\n                    WHEN LOCKED-BUT-UPDATE-FAILED\n                       SET ACUP-CHANGES-OKAYED-BUT-FAILED TO TRUE\n                    WHEN DATA-WAS-CHANGED-BEFORE-UPDATE\n                        SET ACUP-SHOW-DETAILS            TO TRUE\n                    WHEN OTHER\n                       SET ACUP-CHANGES-OKAYED-AND-DONE   TO TRUE\n                 END-EVALUATE\n      ******************************************************************\n      *       DETAILS EDITED , FOUND OK, CONFIRM SAVE REQUESTED\n      *       CONFIRMATION NOT GIVEN. SO SHOW DETAILS AGAIN\n      ******************************************************************\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n                  CONTINUE\n      ******************************************************************\n      *       SHOW CONFIRMATION. GO BACK TO SQUARE 1\n      ******************************************************************\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                  SET ACUP-SHOW-DETAILS TO TRUE\n                  IF CDEMO-FROM-TRANID    EQUAL LOW-VALUES\n                  OR CDEMO-FROM-TRANID    EQUAL SPACES\n                     MOVE ZEROES       TO CDEMO-ACCT-ID\n                                          CDEMO-CARD-NUM\n                     MOVE LOW-VALUES   TO CDEMO-ACCT-STATUS\n                  END-IF\n              WHEN OTHER\n                   MOVE LIT-THISPGM    TO ABEND-CULPRIT\n                   MOVE '0001'         TO ABEND-CODE\n                   MOVE SPACES         TO ABEND-REASON\n                   MOVE 'UNEXPECTED DATA SCENARIO'\n                                       TO ABEND-MSG\n                   PERFORM ABEND-ROUTINE\n                      THRU ABEND-ROUTINE-EXIT\n           END-EVALUATE\n           .\n",
        "paragraph_lines": [2509, 2589],
        "ref_paragraphs": [
          "9000-READ-ACCT",
          "9000-READ-ACCT-EXIT",
          "9600-WRITE-PROCESSING",
          "9600-WRITE-PROCESSING-EXIT",
          "ABEND-ROUTINE",
          "ABEND-ROUTINE-EXIT"
        ],
        "paragraph_logic": [
          "Evaluates different scenarios to decide the next action based on the current state.",
          "Calls the [account read process]<9000-READ-ACCT> if account details are not fetched and then verifies if the customer exists in the master file.",
          "Checks for input errors or unchanged data when details are shown and handles confirmation for changes if detected.",
          "Calls the [write processing routine]<9600-WRITE-PROCESSING> to save changes if requested and then handles different outcomes, setting flags for lock errors or successful updates.",
          "Shows details again or proceeds to confirmation based on the users input and changes status.",
          "If an unexpected scenario is encountered, performs the [abend routine]<ABEND-ROUTINE> to handle abnormal termination."
        ]
      },
      "2000-DECIDE-ACTION-EXIT": {
        "paragraph_name": "2000-DECIDE-ACTION-EXIT",
        "section": "procedure division",
        "paragraph_code": "2000-DECIDE-ACTION-EXIT.\n           EXIT\n           .\n\n\n\n",
        "paragraph_lines": [2590, 2592],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the paragraph [2000-DECIDE-ACTION-EXIT] after completing its logic or path statements."
        ]
      },
      "3000-SEND-MAP": {
        "paragraph_name": "3000-SEND-MAP",
        "section": "procedure division",
        "paragraph_code": "3000-SEND-MAP.\n           PERFORM 3100-SCREEN-INIT\n              THRU 3100-SCREEN-INIT-EXIT\n           PERFORM 3200-SETUP-SCREEN-VARS\n              THRU 3200-SETUP-SCREEN-VARS-EXIT\n           PERFORM 3250-SETUP-INFOMSG\n              THRU 3250-SETUP-INFOMSG-EXIT\n           PERFORM 3300-SETUP-SCREEN-ATTRS\n              THRU 3300-SETUP-SCREEN-ATTRS-EXIT\n           PERFORM 3390-SETUP-INFOMSG-ATTRS\n              THRU 3390-SETUP-INFOMSG-ATTRS-EXIT\n           PERFORM 3400-SEND-SCREEN\n              THRU 3400-SEND-SCREEN-EXIT\n           .\n\n",
        "paragraph_lines": [2596, 2609],
        "ref_paragraphs": [
          "3100-SCREEN-INIT",
          "3100-SCREEN-INIT-EXIT",
          "3200-SETUP-SCREEN-VARS",
          "3200-SETUP-SCREEN-VARS-EXIT",
          "3250-SETUP-INFOMSG",
          "3250-SETUP-INFOMSG-EXIT",
          "3300-SETUP-SCREEN-ATTRS",
          "3300-SETUP-SCREEN-ATTRS-EXIT",
          "3390-SETUP-INFOMSG-ATTRS",
          "3390-SETUP-INFOMSG-ATTRS-EXIT",
          "3400-SEND-SCREEN",
          "3400-SEND-SCREEN-EXIT"
        ],
        "paragraph_logic": [
          "Calls the [screen initialization process]<3100-SCREEN-INIT> to clear and prepare the screen for new data.",
          "Calls the [screen variables setup process]<3200-SETUP-SCREEN-VARS> to initialize and set up variables that will populate the screen.",
          "Calls the [information message setup process]<3250-SETUP-INFOMSG> to prepare any informational messages that need to be displayed on the screen.",
          "Calls the [screen attribute setup process]<3300-SETUP-SCREEN-ATTRS> to set up attributes like positioning and field lengths for the screen.",
          "Calls the [information message attribute setup process]<3390-SETUP-INFOMSG-ATTRS> to set attributes for the informational messages, such as text color and highlighting.",
          "Calls the [screen sending process]<3400-SEND-SCREEN> to send the screen map to the user, displaying the updated information and messages."
        ]
      },
      "3000-SEND-MAP-EXIT": {
        "paragraph_name": "3000-SEND-MAP-EXIT",
        "section": "procedure division",
        "paragraph_code": "3000-SEND-MAP-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2611, 2613],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Performs the [send map exit process]<3000-SEND-MAP-EXIT> to end the map sending functionality by exiting the current paragraph."
        ]
      },
      "3100-SCREEN-INIT": {
        "paragraph_name": "3100-SCREEN-INIT",
        "section": "procedure division",
        "paragraph_code": "3100-SCREEN-INIT.\n           MOVE LOW-VALUES TO CACTUPAO\n\n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA\n\n           MOVE CCDA-TITLE01              TO TITLE01O OF CACTUPAO\n           MOVE CCDA-TITLE02              TO TITLE02O OF CACTUPAO\n           MOVE LIT-THISTRANID            TO TRNNAMEO OF CACTUPAO\n           MOVE LIT-THISPGM               TO PGMNAMEO OF CACTUPAO\n\n           MOVE FUNCTION CURRENT-DATE     TO WS-CURDATE-DATA\n\n           MOVE WS-CURDATE-MONTH          TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY            TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)      TO WS-CURDATE-YY\n\n           MOVE WS-CURDATE-MM-DD-YY       TO CURDATEO OF CACTUPAO\n\n           MOVE WS-CURTIME-HOURS          TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE         TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND         TO WS-CURTIME-SS\n\n           MOVE WS-CURTIME-HH-MM-SS       TO CURTIMEO OF CACTUPAO\n\n           .\n\n",
        "paragraph_lines": [2615, 2639],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Initializes the screen by setting low-values to the CACTUPAO map.",
          "Moves the current date to the WS-CURDATE-DATA to capture the current system date.",
          "Sets the screen titles and transaction name in CACTUPAO using predefined literals.",
          "Formats the current date components (month, day, year) and sets them in CACTUPAO.",
          "Formats the current time components (hour, minute, second) and sets them in CACTUPAO."
        ]
      },
      "3100-SCREEN-INIT-EXIT": {
        "paragraph_name": "3100-SCREEN-INIT-EXIT",
        "section": "procedure division",
        "paragraph_code": "3100-SCREEN-INIT-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2641, 2643],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the [screen initialization process]<3100-SCREEN-INIT-EXIT>, marking the end of this routine."
        ]
      },
      "3200-SETUP-SCREEN-VARS": {
        "paragraph_name": "3200-SETUP-SCREEN-VARS",
        "section": "procedure division",
        "paragraph_code": "3200-SETUP-SCREEN-VARS.\n      *    INITIALIZE SEARCH CRITERIA\n           IF CDEMO-PGM-ENTER\n              CONTINUE\n           ELSE\n              IF CC-ACCT-ID-N = 0\n              AND FLG-ACCTFILTER-ISVALID\n                 MOVE LOW-VALUES                TO ACCTSIDO OF CACTUPAO\n              ELSE\n                 MOVE CC-ACCT-ID                TO ACCTSIDO OF CACTUPAO\n              END-IF\n\n              EVALUATE TRUE\n                WHEN ACUP-DETAILS-NOT-FETCHED\n                WHEN CC-ACCT-ID-N =  0\n                  PERFORM 3201-SHOW-INITIAL-VALUES\n                     THRU 3201-SHOW-INITIAL-VALUES-EXIT\n               WHEN ACUP-SHOW-DETAILS\n                  PERFORM 3202-SHOW-ORIGINAL-VALUES\n                     THRU 3202-SHOW-ORIGINAL-VALUES-EXIT\n               WHEN ACUP-CHANGES-MADE\n                  PERFORM 3203-SHOW-UPDATED-VALUES\n                     THRU 3203-SHOW-UPDATED-VALUES-EXIT\n               WHEN OTHER\n                  PERFORM 3202-SHOW-ORIGINAL-VALUES\n                     THRU 3202-SHOW-ORIGINAL-VALUES-EXIT\n              END-EVALUATE\n            END-IF\n           .\n",
        "paragraph_lines": [2645, 2673],
        "ref_paragraphs": [
          "3201-SHOW-INITIAL-VALUES",
          "3201-SHOW-INITIAL-VALUES-EXIT",
          "3202-SHOW-ORIGINAL-VALUES",
          "3202-SHOW-ORIGINAL-VALUES-EXIT",
          "3203-SHOW-UPDATED-VALUES",
          "3203-SHOW-UPDATED-VALUES-EXIT",
          "3202-SHOW-ORIGINAL-VALUES",
          "3202-SHOW-ORIGINAL-VALUES-EXIT"
        ],
        "paragraph_logic": [
          "Analyzes search criteria and initializes the screen variables by checking if it is the programs first entry.",
          "If the account ID is zero and account filter is valid, moves low-values to the account ID field.",
          "Otherwise, moves the account ID to the appropriate field.",
          "Evaluates different conditions and performs various actions:",
          "- Calls the [show initial values process]<3201-SHOW-INITIAL-VALUES> for initial screen setup when details are not fetched or account ID is zero.",
          "- Calls the [show original values process]<3202-SHOW-ORIGINAL-VALUES> when original details need to be shown.",
          "- Calls the [show updated values process]<3203-SHOW-UPDATED-VALUES> when changes have been made.",
          "- Defaults to [show original values process]<3202-SHOW-ORIGINAL-VALUES> for any other conditions."
        ]
      },
      "3200-SETUP-SCREEN-VARS-EXIT": {
        "paragraph_name": "3200-SETUP-SCREEN-VARS-EXIT",
        "section": "procedure division",
        "paragraph_code": "3200-SETUP-SCREEN-VARS-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2674, 2676],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Calls the exit statement to leave the current processing routine and return control to the calling paragraph."
        ]
      },
      "3201-SHOW-INITIAL-VALUES": {
        "paragraph_name": "3201-SHOW-INITIAL-VALUES",
        "section": "procedure division",
        "paragraph_code": "3201-SHOW-INITIAL-VALUES.\n           MOVE LOW-VALUES                     TO  ACSTTUSO OF CACTUPAO\n                                                   ACRDLIMO OF CACTUPAO\n      *Account Limits\n                                                   ACURBALO OF CACTUPAO\n                                                   ACSHLIMO OF CACTUPAO\n                                                   ACRCYCRO OF CACTUPAO\n                                                   ACRCYDBO OF CACTUPAO\n      *Account Dates\n                                                   OPNYEARO OF CACTUPAO\n                                                   OPNMONO  OF CACTUPAO\n                                                   OPNDAYO  OF CACTUPAO\n                                                   EXPYEARO OF CACTUPAO\n                                                   EXPMONO  OF CACTUPAO\n                                                   EXPDAYO  OF CACTUPAO\n                                                   RISYEARO OF CACTUPAO\n                                                   RISMONO  OF CACTUPAO\n                                                   RISDAYO  OF CACTUPAO\n                                                   AADDGRPO OF CACTUPAO\n      *Customer data\n                                                   ACSTNUMO OF CACTUPAO\n                                                   ACTSSN1O OF CACTUPAO\n                                                   ACTSSN2O OF CACTUPAO\n                                                   ACTSSN3O OF CACTUPAO\n                                                   ACSTFCOO OF CACTUPAO\n                                                   DOBYEARO OF CACTUPAO\n                                                   DOBMONO  OF CACTUPAO\n                                                   DOBDAYO  OF CACTUPAO\n                                                   ACSFNAMO OF CACTUPAO\n                                                   ACSMNAMO OF CACTUPAO\n                                                   ACSLNAMO OF CACTUPAO\n      *Customer address and contact info\n                                                   ACSADL1O OF CACTUPAO\n                                                   ACSADL2O OF CACTUPAO\n                                                   ACSCITYO OF CACTUPAO\n                                                   ACSSTTEO OF CACTUPAO\n                                                   ACSZIPCO OF CACTUPAO\n                                                   ACSCTRYO OF CACTUPAO\n\n                                                   ACSPH1AO OF CACTUPAO\n                                                   ACSPH1BO OF CACTUPAO\n                                                   ACSPH1CO OF CACTUPAO\n                                                   ACSPH2AO OF CACTUPAO\n                                                   ACSPH2BO OF CACTUPAO\n                                                   ACSPH2CO OF CACTUPAO\n\n      *Customer other good stuff\n                                                   ACSGOVTO OF CACTUPAO\n                                                   ACSEFTCO OF CACTUPAO\n                                                   ACSPFLGO OF CACTUPAO\n           .\n\n",
        "paragraph_lines": [2678, 2728],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Calls the [initial values process]<3201-SHOW-INITIAL-VALUES> to initialize account status, limits, and balances to low values.",
          "Initializes account date fields like opening year, expiration date, and risk date to low values.",
          "Sets customer data fields like name, social security number, and date of birth to low values.",
          "Updates customer address and contact information fields, including city, state, and phone numbers to low values.",
          "Populates additional customer-related fields like government, electronic funds transfer, and profile flag with low values."
        ]
      },
      "3201-SHOW-INITIAL-VALUES-EXIT": {
        "paragraph_name": "3201-SHOW-INITIAL-VALUES-EXIT",
        "section": "procedure division",
        "paragraph_code": "3201-SHOW-INITIAL-VALUES-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2730, 2732],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "The paragraph 3201-SHOW-INITIAL-VALUES-EXIT exits the procedure, marking the end of processing for the current logic.",
          "- Exits the procedure by reaching the EXIT statement."
        ]
      },
      "3202-SHOW-ORIGINAL-VALUES": {
        "paragraph_name": "3202-SHOW-ORIGINAL-VALUES",
        "section": "procedure division",
        "paragraph_code": "3202-SHOW-ORIGINAL-VALUES.\n\n           MOVE LOW-VALUES                     TO WS-NON-KEY-FLAGS\n\n           SET PROMPT-FOR-CHANGES              TO TRUE\n\n           IF FOUND-ACCT-IN-MASTER\n           OR FOUND-CUST-IN-MASTER\n              MOVE ACUP-OLD-ACTIVE-STATUS      TO ACSTTUSO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-BAL-N         TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO\n\n              MOVE ACUP-OLD-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO\n\n              MOVE ACUP-OLD-CASH-CREDIT-LIMIT-N\n                                               TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO\n\n              MOVE ACUP-OLD-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO\n\n              MOVE ACUP-OLD-OPEN-YEAR          TO OPNYEARO OF CACTUPAO\n              MOVE ACUP-OLD-OPEN-MON           TO OPNMONO  OF CACTUPAO\n              MOVE ACUP-OLD-OPEN-DAY           TO OPNDAYO  OF CACTUPAO\n\n              MOVE ACUP-OLD-EXP-YEAR           TO EXPYEARO OF CACTUPAO\n              MOVE ACUP-OLD-EXP-MON            TO EXPMONO  OF CACTUPAO\n              MOVE ACUP-OLD-EXP-DAY            TO EXPDAYO  OF CACTUPAO\n\n              MOVE ACUP-OLD-REISSUE-YEAR       TO RISYEARO OF CACTUPAO\n              MOVE ACUP-OLD-REISSUE-MON        TO RISMONO  OF CACTUPAO\n              MOVE ACUP-OLD-REISSUE-DAY        TO RISDAYO  OF CACTUPAO\n              MOVE ACUP-OLD-GROUP-ID           TO AADDGRPO OF CACTUPAO\n           END-IF\n\n           IF FOUND-CUST-IN-MASTER\n              MOVE ACUP-OLD-CUST-ID-X          TO ACSTNUMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(1:3)    TO ACTSSN1O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(4:2)    TO ACTSSN2O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-SSN-X(6:4)    TO ACTSSN3O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-FICO-SCORE-X  TO ACSTFCOO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-YEAR      TO DOBYEARO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-MON       TO DOBMONO  OF CACTUPAO\n              MOVE ACUP-OLD-CUST-DOB-DAY       TO DOBDAYO  OF CACTUPAO\n              MOVE ACUP-OLD-CUST-FIRST-NAME    TO ACSFNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-MIDDLE-NAME   TO ACSMNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-LAST-NAME     TO ACSLNAMO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-1   TO ACSADL1O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-2   TO ACSADL2O OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-LINE-3   TO ACSCITYO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-STATE-CD TO ACSSTTEO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-ZIP      TO ACSZIPCO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-ADDR-COUNTRY-CD\n                                               TO ACSCTRYO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(2:3)\n                                               TO ACSPH1AO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(6:3)\n                                               TO ACSPH1BO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-1(10:4)\n                                               TO ACSPH1CO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(2:3)\n                                               TO ACSPH2AO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(6:3)\n                                               TO ACSPH2BO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PHONE-NUM-2(10:4)\n                                               TO ACSPH2CO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-GOVT-ISSUED-ID\n                                               TO ACSGOVTO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-EFT-ACCOUNT-ID\n                                               TO ACSEFTCO OF CACTUPAO\n              MOVE ACUP-OLD-CUST-PRI-HOLDER-IND\n                                               TO ACSPFLGO OF CACTUPAO\n           END-IF\n           .\n\n",
        "paragraph_lines": [2734, 2812],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Sets low values to the non-key flags and prompts for changes.",
          "If the account or customer is found in the master file, moves the old account and customer values to the corresponding output fields.",
          "Sets various account-related fields like active status, current balance, credit limit, and opening dates.",
          "Sets various customer-related fields like customer ID, SSN, FICO score, name, address, and contact information.",
          "Updates additional customer-specific information such as government-issued ID, EFT account ID, and primary holder indicator."
        ]
      },
      "3202-SHOW-ORIGINAL-VALUES-EXIT": {
        "paragraph_name": "3202-SHOW-ORIGINAL-VALUES-EXIT",
        "section": "procedure division",
        "paragraph_code": "3202-SHOW-ORIGINAL-VALUES-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [2814, 2816],
        "ref_paragraphs": [],
        "paragraph_logic": ["Exits the paragraph without performing any additional operations."]
      },
      "3203-SHOW-UPDATED-VALUES": {
        "paragraph_name": "3203-SHOW-UPDATED-VALUES",
        "section": "procedure division",
        "paragraph_code": "3203-SHOW-UPDATED-VALUES.\n\n           MOVE ACUP-NEW-ACTIVE-STATUS         TO ACSTTUSO OF CACTUPAO\n\n           IF FLG-CRED-LIMIT-ISVALID\n              MOVE ACUP-NEW-CREDIT-LIMIT-N     TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRDLIMO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CREDIT-LIMIT-X     TO ACRDLIMO OF CACTUPAO\n           END-IF\n\n           IF FLG-CASH-CREDIT-LIMIT-ISVALID\n              MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N\n                                               TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACSHLIMO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CASH-CREDIT-LIMIT-X\n                                               TO ACSHLIMO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-BAL-ISVALID\n              MOVE ACUP-NEW-CURR-BAL-N OF ACUP-NEW-DETAILS TO\n                               WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACURBALO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-BAL-X         TO ACURBALO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-CYC-CREDIT-ISVALID\n              MOVE ACUP-NEW-CURR-CYC-CREDIT-N  TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYCRO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-CYC-CREDIT-X  TO ACRCYCRO OF CACTUPAO\n           END-IF\n\n           IF FLG-CURR-CYC-DEBIT-ISVALID\n              MOVE ACUP-NEW-CURR-CYC-DEBIT-N   TO WS-EDIT-CURRENCY-9-2-F\n              MOVE WS-EDIT-CURRENCY-9-2-F      TO ACRCYDBO OF CACTUPAO\n           ELSE\n              MOVE ACUP-NEW-CURR-CYC-DEBIT-X   TO ACRCYDBO OF CACTUPAO\n           END-IF\n\n           MOVE ACUP-NEW-OPEN-YEAR             TO OPNYEARO OF CACTUPAO\n           MOVE ACUP-NEW-OPEN-MON              TO OPNMONO  OF CACTUPAO\n           MOVE ACUP-NEW-OPEN-DAY              TO OPNDAYO  OF CACTUPAO\n\n           MOVE ACUP-NEW-EXP-YEAR              TO EXPYEARO OF CACTUPAO\n           MOVE ACUP-NEW-EXP-MON               TO EXPMONO  OF CACTUPAO\n           MOVE ACUP-NEW-EXP-DAY               TO EXPDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-YEAR          TO RISYEARO OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-MON           TO RISMONO  OF CACTUPAO\n           MOVE ACUP-NEW-REISSUE-DAY           TO RISDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-GROUP-ID              TO AADDGRPO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ID-X             TO ACSTNUMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-1            TO ACTSSN1O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-2            TO ACTSSN2O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-SSN-3            TO ACTSSN3O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-FICO-SCORE-X     TO ACSTFCOO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-YEAR         TO DOBYEARO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-MON          TO DOBMONO  OF CACTUPAO\n           MOVE ACUP-NEW-CUST-DOB-DAY          TO DOBDAYO  OF CACTUPAO\n           MOVE ACUP-NEW-CUST-FIRST-NAME       TO ACSFNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-MIDDLE-NAME      TO ACSMNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-LAST-NAME        TO ACSLNAMO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-1      TO ACSADL1O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-2      TO ACSADL2O OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-LINE-3      TO ACSCITYO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-STATE-CD    TO ACSSTTEO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-ZIP         TO ACSZIPCO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-ADDR-COUNTRY-CD  TO ACSCTRYO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1A     TO ACSPH1AO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1B     TO ACSPH1BO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-1C     TO ACSPH1CO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2A     TO ACSPH2AO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2B     TO ACSPH2BO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PHONE-NUM-2C     TO ACSPH2CO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-GOVT-ISSUED-ID   TO ACSGOVTO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID   TO ACSEFTCO OF CACTUPAO\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND   TO ACSPFLGO OF CACTUPAO\n\n           .\n\n",
        "paragraph_lines": [2817, 2897],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Updates the accounts active status from the new active status field.",
          "Validates and moves the new credit limit values if they meet the validity criteria, otherwise uses the default.",
          "Validates and moves the new cash credit limit values if they meet the validity criteria, otherwise uses the default.",
          "Validates and moves the new current balance values if they meet the validity criteria, otherwise uses the default.",
          "Validates and moves the new cycle credit and debit values if they meet the validity criteria, otherwise uses the default.",
          "Transfers the new customer and account details, including open date, expiry date, reissue date, personal information, address, and contact details, to the account record."
        ]
      },
      "3203-SHOW-UPDATED-VALUES-EXIT": {
        "paragraph_name": "3203-SHOW-UPDATED-VALUES-EXIT",
        "section": "procedure division",
        "paragraph_code": "3203-SHOW-UPDATED-VALUES-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [2899, 2901],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the paragraph, marking the end of the SHOW UPDATED VALUES routine."
        ]
      },
      "3250-SETUP-INFOMSG": {
        "paragraph_name": "3250-SETUP-INFOMSG",
        "section": "procedure division",
        "paragraph_code": "3250-SETUP-INFOMSG.\n      *    SETUP INFORMATION MESSAGE\n           EVALUATE TRUE\n               WHEN CDEMO-PGM-ENTER\n                    SET  PROMPT-FOR-SEARCH-KEYS TO TRUE\n               WHEN ACUP-DETAILS-NOT-FETCHED\n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE\n               WHEN ACUP-SHOW-DETAILS\n                    SET PROMPT-FOR-CHANGES         TO TRUE\n               WHEN ACUP-CHANGES-NOT-OK\n                    SET PROMPT-FOR-CHANGES         TO TRUE\n               WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n                    SET PROMPT-FOR-CONFIRMATION    TO TRUE\n               WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                    SET CONFIRM-UPDATE-SUCCESS     TO TRUE\n\n               WHEN ACUP-CHANGES-OKAYED-LOCK-ERROR\n                    SET INFORM-FAILURE             TO TRUE\n               WHEN ACUP-CHANGES-OKAYED-BUT-FAILED\n                    SET INFORM-FAILURE             TO TRUE\n               WHEN WS-NO-INFO-MESSAGE\n                   SET PROMPT-FOR-SEARCH-KEYS      TO TRUE\n           END-EVALUATE\n\n           MOVE WS-INFO-MSG                    TO INFOMSGO OF CACTUPAO\n\n           MOVE WS-RETURN-MSG                  TO ERRMSGO OF CACTUPAO\n           .\n",
        "paragraph_lines": [2903, 2930],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Evaluates different conditions to set appropriate informational and error messages.",
          "Sets prompt for search keys if the program is entered or details are not fetched.",
          "Sets prompt for changes if details are shown or changes are not okay.",
          "Sets prompt for confirmation if changes are okay but not confirmed.",
          "Sets success or failure messages based on the final status of changes.",
          "Moves the informational and return messages to their respective fields in the output area."
        ]
      },
      "3250-SETUP-INFOMSG-EXIT": {
        "paragraph_name": "3250-SETUP-INFOMSG-EXIT",
        "section": "procedure division",
        "paragraph_code": "3250-SETUP-INFOMSG-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [2931, 2933],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the [information message setup process]<3250-SETUP-INFOMSG-EXIT>, indicating the end of this procedure."
        ]
      },
      "3300-SETUP-SCREEN-ATTRS": {
        "paragraph_name": "3300-SETUP-SCREEN-ATTRS",
        "section": "procedure division",
        "paragraph_code": "3300-SETUP-SCREEN-ATTRS.\n\n      *    PROTECT ALL FIELDS\n           PERFORM 3310-PROTECT-ALL-ATTRS\n              THRU 3310-PROTECT-ALL-ATTRS-EXIT\n\n      *    UNPROTECT BASED ON CONTEXT\n           EVALUATE TRUE\n              WHEN ACUP-DETAILS-NOT-FETCHED\n      *            Make Account Id editable\n                   MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI\n              WHEN  ACUP-SHOW-DETAILS\n              WHEN  ACUP-CHANGES-NOT-OK\n                   PERFORM 3320-UNPROTECT-FEW-ATTRS\n                      THRU 3320-UNPROTECT-FEW-ATTRS-EXIT\n              WHEN ACUP-CHANGES-OK-NOT-CONFIRMED\n              WHEN ACUP-CHANGES-OKAYED-AND-DONE\n                   CONTINUE\n              WHEN OTHER\n                   MOVE DFHBMFSE      TO ACCTSIDA OF CACTUPAI\n           END-EVALUATE\n\n      *    POSITION CURSOR - ORDER BASED ON SCREEN LOCATION\n           EVALUATE TRUE\n              WHEN FOUND-ACCOUNT-DATA\n              WHEN NO-CHANGES-DETECTED\n                  MOVE -1              TO ACSTTUSL OF CACTUPAI\n              WHEN FLG-ACCTFILTER-NOT-OK\n              WHEN FLG-ACCTFILTER-BLANK\n                   MOVE -1             TO ACCTSIDL OF CACTUPAI\n      *    Account Status\n              WHEN FLG-ACCT-STATUS-NOT-OK\n              WHEN FLG-ACCT-STATUS-BLANK\n                  MOVE -1              TO ACSTTUSL OF CACTUPAI\n      *    Open Year\n              WHEN FLG-OPEN-YEAR-NOT-OK\n              WHEN FLG-OPEN-YEAR-BLANK\n                  MOVE -1              TO OPNYEARL OF CACTUPAI\n      *    Open Month\n              WHEN FLG-OPEN-MONTH-NOT-OK\n              WHEN FLG-OPEN-MONTH-BLANK\n                  MOVE -1              TO OPNMONL  OF CACTUPAI\n      *    Open Day\n              WHEN FLG-OPEN-DAY-NOT-OK\n              WHEN FLG-OPEN-DAY-BLANK\n                  MOVE -1              TO OPNDAYL  OF CACTUPAI\n      *    Credit Limit\n              WHEN FLG-CRED-LIMIT-NOT-OK\n              WHEN FLG-CRED-LIMIT-BLANK\n                  MOVE -1              TO ACRDLIML OF CACTUPAI\n      *    Expiry Year\n              WHEN FLG-EXPIRY-YEAR-NOT-OK\n              WHEN FLG-EXPIRY-YEAR-BLANK\n                  MOVE -1              TO EXPYEARL OF CACTUPAI\n      *    Expiry Month\n              WHEN FLG-EXPIRY-MONTH-NOT-OK\n              WHEN FLG-EXPIRY-MONTH-BLANK\n                  MOVE -1              TO EXPMONL  OF CACTUPAI\n      *    Expiry Day\n              WHEN FLG-EXPIRY-DAY-NOT-OK\n              WHEN FLG-EXPIRY-DAY-BLANK\n                  MOVE -1              TO EXPDAYL  OF CACTUPAI\n      *    Cash credit limit\n              WHEN FLG-CASH-CREDIT-LIMIT-NOT-OK\n              WHEN FLG-CASH-CREDIT-LIMIT-BLANK\n                  MOVE -1              TO ACSHLIML OF CACTUPAI\n      *    Reissue Year\n              WHEN FLG-REISSUE-YEAR-NOT-OK\n              WHEN FLG-REISSUE-YEAR-BLANK\n                  MOVE -1              TO RISYEARL OF CACTUPAI\n      *    Expiry Month\n              WHEN FLG-REISSUE-MONTH-NOT-OK\n              WHEN FLG-REISSUE-MONTH-BLANK\n                  MOVE -1              TO RISMONL  OF CACTUPAI\n      *    Expiry Day\n              WHEN FLG-REISSUE-DAY-NOT-OK\n              WHEN FLG-REISSUE-DAY-BLANK\n                  MOVE -1              TO RISDAYL  OF CACTUPAI\n\n      *    Current Balance\n              WHEN FLG-CURR-BAL-NOT-OK\n              WHEN FLG-CURR-BAL-BLANK\n                  MOVE -1              TO ACURBALL OF CACTUPAI\n      *    Current Cycle Credit\n              WHEN FLG-CURR-CYC-CREDIT-NOT-OK\n              WHEN FLG-CURR-CYC-CREDIT-BLANK\n                  MOVE -1              TO ACRCYCRL OF CACTUPAI\n      *    Current Cycle Debit\n              WHEN FLG-CURR-CYC-DEBIT-NOT-OK\n              WHEN FLG-CURR-CYC-DEBIT-BLANK\n                  MOVE -1              TO ACRCYDBL OF CACTUPAI\n      *    SSN Part 1\n              WHEN FLG-EDIT-US-SSN-PART1-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART1-BLANK\n                  MOVE -1              TO ACTSSN1L OF CACTUPAI\n      *    SSN Part 2\n              WHEN FLG-EDIT-US-SSN-PART2-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART2-BLANK\n                  MOVE -1              TO ACTSSN2L  OF CACTUPAI\n      *    SSN Part 3\n              WHEN FLG-EDIT-US-SSN-PART3-NOT-OK\n              WHEN FLG-EDIT-US-SSN-PART3-BLANK\n                  MOVE -1              TO ACTSSN3L  OF CACTUPAI\n      *    Date of Birth Year\n              WHEN FLG-DT-OF-BIRTH-YEAR-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-YEAR-BLANK\n                  MOVE -1              TO DOBYEARL OF CACTUPAI\n      *    Date of Birth Month\n              WHEN FLG-DT-OF-BIRTH-MONTH-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-MONTH-BLANK\n                  MOVE -1              TO DOBMONL  OF CACTUPAI\n      *    Date of Birth Day\n              WHEN FLG-DT-OF-BIRTH-DAY-NOT-OK\n              WHEN FLG-DT-OF-BIRTH-DAY-BLANK\n                  MOVE -1              TO DOBDAYL  OF CACTUPAI\n      *    FICO Score\n              WHEN FLG-FICO-SCORE-NOT-OK\n              WHEN FLG-FICO-SCORE-BLANK\n                  MOVE -1              TO ACSTFCOL OF CACTUPAI\n      *    First Name\n              WHEN FLG-FIRST-NAME-NOT-OK\n              WHEN FLG-FIRST-NAME-BLANK\n                  MOVE -1              TO ACSFNAML OF CACTUPAI\n      *    Middle Name\n              WHEN FLG-MIDDLE-NAME-NOT-OK\n                  MOVE -1              TO ACSMNAML OF CACTUPAI\n      *    Last Name\n              WHEN FLG-LAST-NAME-NOT-OK\n              WHEN FLG-LAST-NAME-BLANK\n                  MOVE -1              TO ACSLNAML OF CACTUPAI\n      *    Address Line 1\n              WHEN FLG-ADDRESS-LINE-1-NOT-OK\n              WHEN FLG-ADDRESS-LINE-1-BLANK\n                  MOVE -1              TO ACSADL1L OF CACTUPAI\n      *    State (appears next to Line 2 on screen before city)\n              WHEN FLG-STATE-NOT-OK\n              WHEN FLG-STATE-BLANK\n                  MOVE -1              TO ACSSTTEL OF CACTUPAI\n      *    Address Line 2 has no edits\n      *    Zip code\n              WHEN FLG-ZIPCODE-NOT-OK\n              WHEN FLG-ZIPCODE-BLANK\n                  MOVE -1              TO ACSZIPCL OF CACTUPAI\n      *    Address Line 3 (City)\n              WHEN FLG-CITY-NOT-OK\n              WHEN FLG-CITY-BLANK\n                  MOVE -1              TO ACSCITYL OF CACTUPAI\n      *    Country edits.\n              WHEN FLG-COUNTRY-NOT-OK\n              WHEN FLG-COUNTRY-BLANK\n                  MOVE -1              TO ACSCTRYL OF CACTUPAI\n      *    Phone 1\n              WHEN FLG-PHONE-NUM-1A-NOT-OK\n              WHEN FLG-PHONE-NUM-1A-BLANK\n                  MOVE -1              TO ACSPH1AL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-1B-NOT-OK\n              WHEN FLG-PHONE-NUM-1B-BLANK\n                  MOVE -1              TO ACSPH1BL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-1C-NOT-OK\n              WHEN FLG-PHONE-NUM-1C-BLANK\n                  MOVE -1              TO ACSPH1CL OF CACTUPAI\n      *    Phone 2\n              WHEN FLG-PHONE-NUM-2A-NOT-OK\n              WHEN FLG-PHONE-NUM-2A-BLANK\n                  MOVE -1              TO ACSPH2AL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-2B-NOT-OK\n              WHEN FLG-PHONE-NUM-2B-BLANK\n                  MOVE -1              TO ACSPH2BL OF CACTUPAI\n              WHEN FLG-PHONE-NUM-2C-NOT-OK\n              WHEN FLG-PHONE-NUM-2C-BLANK\n                  MOVE -1              TO ACSPH2CL OF CACTUPAI\n      *    EFT Account Id\n              WHEN FLG-EFT-ACCOUNT-ID-NOT-OK\n              WHEN FLG-EFT-ACCOUNT-ID-BLANK\n                  MOVE -1              TO ACSEFTCL OF CACTUPAI\n      *    Primary Card Holder\n              WHEN FLG-PRI-CARDHOLDER-NOT-OK\n              WHEN FLG-PRI-CARDHOLDER-BLANK\n                  MOVE -1              TO ACSPFLGL OF CACTUPAI\n              WHEN OTHER\n                  MOVE -1              TO ACCTSIDL OF CACTUPAI\n            END-EVALUATE\n\n\n      *    SETUP COLOR\n           IF CDEMO-LAST-MAPSET   EQUAL LIT-CCLISTMAPSET\n              MOVE DFHDFCOL            TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n      *    Account Filter\n           IF FLG-ACCTFILTER-NOT-OK\n              MOVE DFHRED              TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n           IF  FLG-ACCTFILTER-BLANK\n           AND CDEMO-PGM-REENTER\n               MOVE '*'                TO ACCTSIDO OF CACTUPAO\n               MOVE DFHRED             TO ACCTSIDC OF CACTUPAO\n           END-IF\n\n           IF ACUP-DETAILS-NOT-FETCHED\n           OR FLG-ACCTFILTER-BLANK\n           OR FLG-ACCTFILTER-NOT-OK\n              GO TO 3300-SETUP-SCREEN-ATTRS-EXIT\n           ELSE\n              CONTINUE\n           END-IF\n\n      ******************************************************************\n      *    Using Copy replacing to set attribs for remaining vars\n      *    Write specific code only if rules differ\n      ******************************************************************\n      *    IF (FLG-ACCT-STATUS-NOT-OK\n      *    OR  FLG-ACCT-STATUS-BLANK)\n      *    AND CDEMO-PGM-REENTER\n      *        MOVE DFHRED             TO ACSTTUSC OF CACTUPAO\n      *        IF  FLG-ACCT-STATUS-BLANK\n      *            MOVE '*'            TO ACSTTUSO OF CACTUPAO\n      *        END-IF\n      *    END-IF\n\n      *    Account Status\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ACCT-STATUS==\n             ==(SCRNVAR2)== BY ==ACSTTUS==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-YEAR==\n             ==(SCRNVAR2)== BY ==OPNYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-MONTH==\n             ==(SCRNVAR2)== BY ==OPNMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Open Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==OPEN-DAY==\n             ==(SCRNVAR2)== BY ==OPNDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Credit Limit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CRED-LIMIT==\n             ==(SCRNVAR2)== BY ==ACRDLIM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-YEAR==\n             ==(SCRNVAR2)== BY ==EXPYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-MONTH==\n             ==(SCRNVAR2)== BY ==EXPMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Expiry Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EXPIRY-DAY==\n             ==(SCRNVAR2)== BY ==EXPDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Cash Credit Limit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CASH-CREDIT-LIMIT==\n             ==(SCRNVAR2)== BY ==ACSHLIM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-YEAR==\n             ==(SCRNVAR2)== BY ==RISYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-MONTH==\n             ==(SCRNVAR2)== BY ==RISMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Reissue Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==REISSUE-DAY==\n             ==(SCRNVAR2)== BY ==RISDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Balance\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-BAL==\n             ==(SCRNVAR2)== BY ==ACURBAL==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Cycle Credit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-CYC-CREDIT==\n             ==(SCRNVAR2)== BY ==ACRCYCR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Current Cycle Debit\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CURR-CYC-DEBIT==\n             ==(SCRNVAR2)== BY ==ACRCYDB==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 1\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART1==\n             ==(SCRNVAR2)== BY ==ACTSSN1==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 2\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART2==\n             ==(SCRNVAR2)== BY ==ACTSSN2==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    SSN Part 3\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EDIT-US-SSN-PART3==\n             ==(SCRNVAR2)== BY ==ACTSSN3==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Year\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-YEAR==\n             ==(SCRNVAR2)== BY ==DOBYEAR==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Month\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-MONTH==\n             ==(SCRNVAR2)== BY ==DOBMON==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Date of Birth Day\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==DT-OF-BIRTH-DAY==\n             ==(SCRNVAR2)== BY ==DOBDAY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    FICO Score\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==FICO-SCORE==\n             ==(SCRNVAR2)== BY ==ACSTFCO==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    First Name\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==FIRST-NAME==\n             ==(SCRNVAR2)== BY ==ACSFNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Middle Name (no edits coded)\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==MIDDLE-NAME==\n             ==(SCRNVAR2)== BY ==ACSMNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Last Name\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==LAST-NAME==\n             ==(SCRNVAR2)== BY ==ACSLNAM==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Address Line 1\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ADDRESS-LINE-1==\n             ==(SCRNVAR2)== BY ==ACSADL1==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    State\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==STATE==\n             ==(SCRNVAR2)== BY ==ACSSTTE==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Address Line 2 (NO EDITS CODED AS YET)\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ADDRESS-LINE-2==\n             ==(SCRNVAR2)== BY ==ACSADL2==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    State\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==ZIPCODE==\n             ==(SCRNVAR2)== BY ==ACSZIPC==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    City\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==CITY==\n             ==(SCRNVAR2)== BY ==ACSCITY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Country\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==COUNTRY==\n             ==(SCRNVAR2)== BY ==ACSCTRY==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 1 Area Code\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1A==\n             ==(SCRNVAR2)== BY ==ACSPH1A==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 1 Prefix\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1B==\n             ==(SCRNVAR2)== BY ==ACSPH1B==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Phone 1 Line number\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-1C==\n             ==(SCRNVAR2)== BY ==ACSPH1C==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 2 Area Code\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2A==\n             ==(SCRNVAR2)== BY ==ACSPH2A==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n\n      *    Phone 2 Prefix\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2B==\n             ==(SCRNVAR2)== BY ==ACSPH2B==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Phone 2 Line number\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PHONE-NUM-2C==\n             ==(SCRNVAR2)== BY ==ACSPH2C==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    EFT Account Id\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==PRI-CARDHOLDER==\n             ==(SCRNVAR2)== BY ==ACSPFLG==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n      *    Primary Card Holder\n           COPY CSSETATY REPLACING\n             ==(TESTVAR1)== BY ==EFT-ACCOUNT-ID==\n             ==(SCRNVAR2)== BY ==ACSEFTC==\n             ==(MAPNAME3)== BY ==CACTUPA== .\n           .\n",
        "paragraph_lines": [2934, 3384],
        "ref_paragraphs": [
          "3310-PROTECT-ALL-ATTRS",
          "3310-PROTECT-ALL-ATTRS-EXIT",
          "3320-UNPROTECT-FEW-ATTRS",
          "3320-UNPROTECT-FEW-ATTRS-EXIT"
        ],
        "paragraph_logic": [
          "Performs the [protect all attributes process]<3310-PROTECT-ALL-ATTRS> to protect all fields on the screen.",
          "Evaluates various conditions to determine which fields should be editable or remain protected.",
          "Positions the cursor and sets screen attribute based on different account and filter conditions.",
          "Sets up colors and specific field attributes if they meet certain criteria for display or input.",
          "Uses COPY statements to replicate attribute settings for multiple fields and variables on the screen efficiently."
        ]
      },
      "3300-SETUP-SCREEN-ATTRS-EXIT": {
        "paragraph_name": "3300-SETUP-SCREEN-ATTRS-EXIT",
        "section": "procedure division",
        "paragraph_code": "3300-SETUP-SCREEN-ATTRS-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [3385, 3387],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the [setup screen attributes process]<3300-SETUP-SCREEN-ATTRS-EXIT> once the attribute setup is complete."
        ]
      },
      "3310-PROTECT-ALL-ATTRS": {
        "paragraph_name": "3310-PROTECT-ALL-ATTRS",
        "section": "procedure division",
        "paragraph_code": "3310-PROTECT-ALL-ATTRS.\n           MOVE DFHBMPRF              TO ACCTSIDA OF CACTUPAI\n                                         ACSTTUSA OF CACTUPAI\n      *Account Limits\n                                         ACRDLIMA OF CACTUPAI\n                                         ACSHLIMA OF CACTUPAI\n                                         ACURBALA OF CACTUPAI\n                                         ACRCYCRA OF CACTUPAI\n                                         ACRCYDBA OF CACTUPAI\n      *Account dates\n                                         OPNYEARA OF CACTUPAI\n                                         OPNMONA  OF CACTUPAI\n                                         OPNDAYA  OF CACTUPAI\n                                         EXPYEARA OF CACTUPAI\n                                         EXPMONA  OF CACTUPAI\n                                         EXPDAYA  OF CACTUPAI\n                                         RISYEARA OF CACTUPAI\n                                         RISMONA  OF CACTUPAI\n                                         RISDAYA  OF CACTUPAI\n\n                                         AADDGRPA OF CACTUPAI\n      *Customer data\n                                         ACSTNUMA OF CACTUPAI\n                                         ACTSSN1A OF CACTUPAI\n                                         ACTSSN2A OF CACTUPAI\n                                         ACTSSN3A OF CACTUPAI\n                                         ACSTFCOA OF CACTUPAI\n      *Date of Birth\n                                         DOBYEARA OF CACTUPAI\n                                         DOBMONA  OF CACTUPAI\n                                         DOBDAYA  OF CACTUPAI\n\n                                         ACSFNAMA OF CACTUPAI\n                                         ACSMNAMA OF CACTUPAI\n                                         ACSLNAMA OF CACTUPAI\n      *Address\n                                         ACSADL1A OF CACTUPAI\n                                         ACSADL2A OF CACTUPAI\n                                         ACSCITYA OF CACTUPAI\n                                         ACSSTTEA OF CACTUPAI\n                                         ACSZIPCA OF CACTUPAI\n                                         ACSCTRYA OF CACTUPAI\n\n                                         ACSPH1AA OF CACTUPAI\n                                         ACSPH1BA OF CACTUPAI\n                                         ACSPH1CA OF CACTUPAI\n                                         ACSPH2AA OF CACTUPAI\n                                         ACSPH2BA OF CACTUPAI\n                                         ACSPH2CA OF CACTUPAI\n\n                                         ACSGOVTA OF CACTUPAI\n                                         ACSEFTCA OF CACTUPAI\n                                         ACSPFLGA OF CACTUPAI\n                                         INFOMSGA OF CACTUPAI\n           .\n",
        "paragraph_lines": [3389, 3443],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Sets all account SID and status attributes to protected mode.",
          "Sets all account limit attributes to protected mode.",
          "Sets all account date attributes to protected mode.",
          "Sets all customer data attributes to protected mode.",
          "Sets all date of birth attributes to protected mode.",
          "Sets all address attributes to protected mode."
        ]
      },
      "3310-PROTECT-ALL-ATTRS-EXIT": {
        "paragraph_name": "3310-PROTECT-ALL-ATTRS-EXIT",
        "section": "procedure division",
        "paragraph_code": "3310-PROTECT-ALL-ATTRS-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [3444, 3446],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Simply exits the 3310-PROTECT-ALL-ATTRS-EXIT paragraph after completing any preceding operations."
        ]
      },
      "3320-UNPROTECT-FEW-ATTRS": {
        "paragraph_name": "3320-UNPROTECT-FEW-ATTRS",
        "section": "procedure division",
        "paragraph_code": "3320-UNPROTECT-FEW-ATTRS.\n\n           MOVE DFHBMFSE              TO ACSTTUSA OF CACTUPAI\n      *Account Limits\n                                         ACRDLIMA OF CACTUPAI\n                                         ACSHLIMA OF CACTUPAI\n                                         ACURBALA OF CACTUPAI\n                                         ACRCYCRA OF CACTUPAI\n                                         ACRCYDBA OF CACTUPAI\n      *Account dates\n      *Open Date\n                                         OPNYEARA OF CACTUPAI\n                                         OPNMONA  OF CACTUPAI\n                                         OPNDAYA  OF CACTUPAI\n      *Expiry date\n                                         EXPYEARA OF CACTUPAI\n                                         EXPMONA  OF CACTUPAI\n                                         EXPDAYA  OF CACTUPAI\n      *Reissue date\n                                         RISYEARA OF CACTUPAI\n                                         RISMONA  OF CACTUPAI\n                                         RISDAYA  OF CACTUPAI\n      *Date of Birth\n                                         DOBYEARA OF CACTUPAI\n                                         DOBMONA  OF CACTUPAI\n                                         DOBDAYA  OF CACTUPAI\n\n\n\n                                         AADDGRPA OF CACTUPAI\n      *Customer data\n            MOVE DFHBMPRF            TO  ACSTNUMA OF CACTUPAI\n            MOVE DFHBMFSE            TO  ACTSSN1A OF CACTUPAI\n                                         ACTSSN2A OF CACTUPAI\n                                         ACTSSN3A OF CACTUPAI\n                                         ACSTFCOA OF CACTUPAI\n\n                                         ACSFNAMA OF CACTUPAI\n                                         ACSMNAMA OF CACTUPAI\n                                         ACSLNAMA OF CACTUPAI\n      *Address\n                                         ACSADL1A OF CACTUPAI\n                                         ACSADL2A OF CACTUPAI\n                                         ACSCITYA OF CACTUPAI\n                                         ACSSTTEA OF CACTUPAI\n                                         ACSZIPCA OF CACTUPAI\n      *Since most of the edits are USA specific protected country\n           MOVE DFHBMPRF              TO ACSCTRYA OF CACTUPAI\n\n           MOVE DFHBMFSE              TO ACSPH1AA OF CACTUPAI\n                                         ACSPH1BA OF CACTUPAI\n                                         ACSPH1CA OF CACTUPAI\n\n           MOVE DFHBMFSE              TO ACSPH2AA OF CACTUPAI\n                                         ACSPH2BA OF CACTUPAI\n                                         ACSPH2CA OF CACTUPAI\n\n                                         ACSGOVTA OF CACTUPAI\n                                         ACSEFTCA OF CACTUPAI\n                                         ACSPFLGA OF CACTUPAI\n           MOVE DFHBMPRF              TO INFOMSGA OF CACTUPAI\n           .\n",
        "paragraph_lines": [3448, 3509],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Moves the value DFHBMFSE to various account limits fields of CACTUPAI to mark them as unprotected.",
          "Moves the value DFHBMFSE to account open, expiry, reissue, and birth date fields of CACTUPAI to mark them as unprotected.",
          "Places DFHBMPRF into the ACSTNUMA (Customer Number) and ACTSSN1A fields of CACTUPAI to make them unprotected.",
          "Sets DFHBMFSE into customer name and customer address fields within CACTUPAI, making them unprotected.",
          "Sets DFHBMPRF into ACSCTRYA to mark the country field as protected, noting that edits are USA specific.",
          "Ensures DFHBMFSE is set to primary and secondary phone number fields, marking them as unprotected."
        ]
      },
      "3320-UNPROTECT-FEW-ATTRS-EXIT": {
        "paragraph_name": "3320-UNPROTECT-FEW-ATTRS-EXIT",
        "section": "procedure division",
        "paragraph_code": "3320-UNPROTECT-FEW-ATTRS-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [3510, 3512],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the [unprotect few attributes process]<3320-UNPROTECT-FEW-ATTRS-EXIT> without performing any additional operations."
        ]
      },
      "3390-SETUP-INFOMSG-ATTRS": {
        "paragraph_name": "3390-SETUP-INFOMSG-ATTRS",
        "section": "procedure division",
        "paragraph_code": "3390-SETUP-INFOMSG-ATTRS.\n           IF  WS-NO-INFO-MESSAGE\n               MOVE DFHBMDAR           TO INFOMSGA OF CACTUPAI\n           ELSE\n               MOVE DFHBMASB           TO INFOMSGA OF CACTUPAI\n           END-IF\n\n           IF ACUP-CHANGES-MADE\n           AND NOT ACUP-CHANGES-OKAYED-AND-DONE\n               MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI\n           END-IF\n\n           IF PROMPT-FOR-CONFIRMATION\n               MOVE DFHBMASB           TO FKEY05A  OF CACTUPAI\n               MOVE DFHBMASB           TO FKEY12A  OF CACTUPAI\n           END-IF\n\n           .\n",
        "paragraph_lines": [3514, 3531],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Checks presence of informational messages (WS-NO-INFO-MESSAGE) and sets corresponding attribute (INFOMSGA of CACTUPAI) accordingly.",
          "If changes have been made but not confirmed, sets attribute (FKEY12A of CACTUPAI) based on the change status.",
          "If user confirmation is required (PROMPT-FOR-CONFIRMATION), sets attributes (FKEY05A and FKEY12A of CACTUPAI) to prompt user confirmation."
        ]
      },
      "3390-SETUP-INFOMSG-ATTRS-EXIT": {
        "paragraph_name": "3390-SETUP-INFOMSG-ATTRS-EXIT",
        "section": "procedure division",
        "paragraph_code": "3390-SETUP-INFOMSG-ATTRS-EXIT.\n           EXIT\n           .\n\n\n",
        "paragraph_lines": [3532, 3534],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the paragraph <3390-SETUP-INFOMSG-ATTRS-EXIT>, completing the setup of information message attributes."
        ]
      },
      "3400-SEND-SCREEN": {
        "paragraph_name": "3400-SEND-SCREEN",
        "section": "procedure division",
        "paragraph_code": "3400-SEND-SCREEN.\n\n           MOVE LIT-THISMAPSET         TO CCARD-NEXT-MAPSET\n           MOVE LIT-THISMAP            TO CCARD-NEXT-MAP\n\n           EXEC CICS SEND MAP(CCARD-NEXT-MAP)\n                          MAPSET(CCARD-NEXT-MAPSET)\n                          FROM(CACTUPAO)\n                          CURSOR\n                          ERASE\n                          FREEKB\n                          RESP(WS-RESP-CD)\n           END-EXEC\n           .\n",
        "paragraph_lines": [3537, 3550],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Sets the mapset to be used next, moving its identifier to the appropriate field.",
          "Sets the specific map within the mapset, preparing the screen for display.",
          "Executes the CICS command to send the specified map and mapset to the users terminal.",
          "Initiates the cursor at the beginning of the map to enable user input.",
          "Clears the screen and unlocks the keyboard for user interaction.",
          "Checks the response code to handle any exceptions or errors that occur during the sending process."
        ]
      },
      "3400-SEND-SCREEN-EXIT": {
        "paragraph_name": "3400-SEND-SCREEN-EXIT",
        "section": "procedure division",
        "paragraph_code": "3400-SEND-SCREEN-EXIT.\n           EXIT\n           .\n\n\n",
        "paragraph_lines": [3551, 3553],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the end of the 3400-SEND-SCREEN paragraph.",
          "Exits the paragraph and returns control to the calling paragraph or program."
        ]
      },
      "9000-READ-ACCT": {
        "paragraph_name": "9000-READ-ACCT",
        "section": "procedure division",
        "paragraph_code": "9000-READ-ACCT.\n\n           INITIALIZE ACUP-OLD-DETAILS\n\n           SET  WS-NO-INFO-MESSAGE      TO TRUE\n\n           MOVE CC-ACCT-ID              TO ACUP-OLD-ACCT-ID\n                                           WS-CARD-RID-ACCT-ID\n\n           PERFORM 9200-GETCARDXREF-BYACCT\n              THRU 9200-GETCARDXREF-BYACCT-EXIT\n\n           IF FLG-ACCTFILTER-NOT-OK\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n           PERFORM 9300-GETACCTDATA-BYACCT\n              THRU 9300-GETACCTDATA-BYACCT-EXIT\n\n           IF DID-NOT-FIND-ACCT-IN-ACCTDAT\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n           MOVE CDEMO-CUST-ID TO WS-CARD-RID-CUST-ID\n\n           PERFORM 9400-GETCUSTDATA-BYCUST\n              THRU 9400-GETCUSTDATA-BYCUST-EXIT\n\n           IF DID-NOT-FIND-CUST-IN-CUSTDAT\n              GO TO 9000-READ-ACCT-EXIT\n           END-IF\n\n\n\n           PERFORM 9500-STORE-FETCHED-DATA\n              THRU 9500-STORE-FETCHED-DATA-EXIT\n           .\n\n\n",
        "paragraph_lines": [3556, 3592],
        "ref_paragraphs": [
          "9200-GETCARDXREF-BYACCT",
          "9200-GETCARDXREF-BYACCT-EXIT",
          "9300-GETACCTDATA-BYACCT",
          "9300-GETACCTDATA-BYACCT-EXIT",
          "9400-GETCUSTDATA-BYCUST",
          "9400-GETCUSTDATA-BYCUST-EXIT",
          "9500-STORE-FETCHED-DATA",
          "9500-STORE-FETCHED-DATA-EXIT"
        ],
        "paragraph_logic": [
          "Initializes old account details for processing and prepares the working storage with default values.",
          "Sets the flag to indicate that no account information message should be displayed initially.",
          "Moves the account ID to the old account details and account RID fields for processing.",
          "Calls the [card cross-reference retrieval process by account]<9200-GETCARDXREF-BYACCT> to fetch card details based on the account ID.",
          "If the account filter is not okay, exits the process.",
          "Calls the [account data retrieval process by account]<9300-GETACCTDATA-BYACCT> to fetch more specific account data.",
          "If the account is not found, exits the process.",
          "Moves the customer ID to the card RID for further identification.",
          "Calls the [customer data retrieval process by customer]<9400-GETCUSTDATA-BYCUST> to retrieve customer-specific details.",
          "If the customer is not found, exits the process.",
          "Calls the [store fetched data process]<9500-STORE-FETCHED-DATA> to store all fetched and verified data for further use."
        ]
      },
      "9000-READ-ACCT-EXIT": {
        "paragraph_name": "9000-READ-ACCT-EXIT",
        "section": "procedure division",
        "paragraph_code": "9000-READ-ACCT-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [3595, 3597],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the logical end of the 9000-READ-ACCT process.",
          "Exits the current paragraph and returns control to the calling paragraph."
        ]
      },
      "9200-GETCARDXREF-BYACCT": {
        "paragraph_name": "9200-GETCARDXREF-BYACCT",
        "section": "procedure division",
        "paragraph_code": "9200-GETCARDXREF-BYACCT.\n\n      *    Read the Card file. Access via alternate index ACCTID\n      *\n           EXEC CICS READ\n                DATASET   (LIT-CARDXREFNAME-ACCT-PATH)\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (CARD-XREF-RECORD)\n                LENGTH    (LENGTH OF CARD-XREF-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  MOVE XREF-CUST-ID               TO CDEMO-CUST-ID\n                  MOVE XREF-CARD-NUM              TO CDEMO-CARD-NUM\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                    MOVE WS-RESP-CD               TO ERROR-RESP\n                    MOVE WS-REAS-CD               TO ERROR-RESP2\n                    STRING\n                    'Account:'\n                     WS-CARD-RID-ACCT-ID-X\n                    ' not found in'\n                    ' Cross ref file.  Resp:'\n                    ERROR-RESP\n                    ' Reas:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-CARDXREFNAME-ACCT-PATH TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *          PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n",
        "paragraph_lines": [3598, 3645],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Reads the card file using an alternate index based on account ID.",
          "Evaluates the response code: If successful, moves customer ID and card number to display fields.",
          "Handles not found scenario by setting error flags and crafting an error message.",
          "For other response codes, sets error flags, populates error details, and prepares an error message.",
          "Ends evaluation of the response code for the READ operation."
        ]
      },
      "9200-GETCARDXREF-BYACCT-EXIT": {
        "paragraph_name": "9200-GETCARDXREF-BYACCT-EXIT",
        "section": "procedure division",
        "paragraph_code": "9200-GETCARDXREF-BYACCT-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [3646, 3648],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the end of the paragraph [9200-GETCARDXREF-BYACCT], allowing for an orderly exit.",
          "EXIT statement is used to return to the calling paragraph."
        ]
      },
      "9300-GETACCTDATA-BYACCT": {
        "paragraph_name": "9300-GETACCTDATA-BYACCT",
        "section": "procedure division",
        "paragraph_code": "9300-GETACCTDATA-BYACCT.\n\n           EXEC CICS READ\n                DATASET   (LIT-ACCTFILENAME)\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  SET FOUND-ACCT-IN-MASTER        TO TRUE\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK       TO TRUE\n      *           SET DID-NOT-FIND-ACCT-IN-ACCTDAT TO TRUE\n                  IF WS-RETURN-MSG-OFF\n                    MOVE WS-RESP-CD               TO ERROR-RESP\n                    MOVE WS-REAS-CD               TO ERROR-RESP2\n                    STRING\n                    'Account:'\n                     WS-CARD-RID-ACCT-ID-X\n                    ' not found in'\n                    ' Acct Master file.Resp:'\n                    ERROR-RESP\n                    ' Reas:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n      *\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-ACCTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-ACCTFILENAME           TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *           PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n",
        "paragraph_lines": [3649, 3695],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Executes a CICS read command to fetch account data into the ACCOUNT-RECORD.",
          "Evaluates the response code WS-RESP-CD to determine the outcome of the read operation.",
          "If the read is successful (DFHRESP(NORMAL)), sets FOUND-ACCT-IN-MASTER to true.",
          "If the account is not found (DFHRESP(NOTFND)), sets several flags to indicate errors and constructs an error message.",
          "For any other response, sets generic error flags and populates WS-RETURN-MSG with an error message."
        ]
      },
      "9300-GETACCTDATA-BYACCT-EXIT": {
        "paragraph_name": "9300-GETACCTDATA-BYACCT-EXIT",
        "section": "procedure division",
        "paragraph_code": "9300-GETACCTDATA-BYACCT-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [3696, 3698],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the [GETACCTDATA-BYACCT] subroutine, returning control to the calling procedure."
        ]
      },
      "9400-GETCUSTDATA-BYCUST": {
        "paragraph_name": "9400-GETCUSTDATA-BYCUST",
        "section": "procedure division",
        "paragraph_code": "9400-GETCUSTDATA-BYCUST.\n           EXEC CICS READ\n                DATASET   (LIT-CUSTFILENAME)\n                RIDFLD    (WS-CARD-RID-CUST-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)\n                INTO      (CUSTOMER-RECORD)\n                LENGTH    (LENGTH OF CUSTOMER-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                  SET FOUND-CUST-IN-MASTER        TO TRUE\n               WHEN DFHRESP(NOTFND)\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-CUSTFILTER-NOT-OK       TO TRUE\n      *           SET DID-NOT-FIND-CUST-IN-CUSTDAT TO TRUE\n                  MOVE WS-RESP-CD               TO ERROR-RESP\n                  MOVE WS-REAS-CD               TO ERROR-RESP2\n                  IF WS-RETURN-MSG-OFF\n                    STRING\n                    'CustId:'\n                     WS-CARD-RID-CUST-ID-X\n                    ' not found'\n                    ' in customer master.Resp: '\n                    ERROR-RESP\n                    ' REAS:'\n                    ERROR-RESP2\n                    DELIMITED BY SIZE\n                    INTO WS-RETURN-MSG\n                    END-STRING\n                  END-IF\n               WHEN OTHER\n                  SET INPUT-ERROR                 TO TRUE\n                  SET FLG-CUSTFILTER-NOT-OK                TO TRUE\n                  MOVE 'READ'                     TO ERROR-OPNAME\n                  MOVE LIT-CUSTFILENAME           TO ERROR-FILE\n                  MOVE WS-RESP-CD                 TO ERROR-RESP\n                  MOVE WS-REAS-CD                 TO ERROR-RESP2\n                  MOVE WS-FILE-ERROR-MESSAGE      TO WS-RETURN-MSG\n      *                                              WS-LONG-MSG\n      *           PERFORM SEND-LONG-TEXT\n           END-EVALUATE\n           .\n",
        "paragraph_lines": [3700, 3744],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Executes a CICS READ command to obtain customer data using the customer ID as the key.",
          "Evaluates the response code after the READ command to determine the outcome.",
          "Sets the found customer flag to true if the READ operation is successful.",
          "Sets various error flags and constructs an appropriate error message if the customer is not found.",
          "Handles other response codes by setting error flags and preparing an error message detailing the READ operation failure."
        ]
      },
      "9400-GETCUSTDATA-BYCUST-EXIT": {
        "paragraph_name": "9400-GETCUSTDATA-BYCUST-EXIT",
        "section": "procedure division",
        "paragraph_code": "9400-GETCUSTDATA-BYCUST-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [3745, 3747],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the end of the 9400-GETCUSTDATA-BYCUST paragraph.",
          "Exits the current paragraph and returns control to the calling paragraph."
        ]
      },
      "9500-STORE-FETCHED-DATA": {
        "paragraph_name": "9500-STORE-FETCHED-DATA",
        "section": "procedure division",
        "paragraph_code": "9500-STORE-FETCHED-DATA.\n\n      *    Store Context in Commarea\n      *\n           MOVE ACCT-ID                   TO CDEMO-ACCT-ID\n           MOVE CUST-ID                   TO CDEMO-CUST-ID\n           MOVE CUST-FIRST-NAME           TO CDEMO-CUST-FNAME\n           MOVE CUST-MIDDLE-NAME          TO CDEMO-CUST-MNAME\n           MOVE CUST-LAST-NAME            TO CDEMO-CUST-LNAME\n           MOVE ACCT-ACTIVE-STATUS        TO CDEMO-ACCT-STATUS\n           MOVE XREF-CARD-NUM             TO CDEMO-CARD-NUM\n\n           INITIALIZE ACUP-OLD-DETAILS\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           MOVE ACCT-ID                  TO ACUP-OLD-ACCT-ID\n      * Active Status\n           MOVE ACCT-ACTIVE-STATUS       TO ACUP-OLD-ACTIVE-STATUS\n      * Current Balance\n           MOVE ACCT-CURR-BAL            TO ACUP-OLD-CURR-BAL-N\n      * Credit Limit\n           MOVE ACCT-CREDIT-LIMIT        TO ACUP-OLD-CREDIT-LIMIT-N\n      * Cash Limit\n           MOVE ACCT-CASH-CREDIT-LIMIT   TO ACUP-OLD-CASH-CREDIT-LIMIT-N\n      * Current Cycle Credit\n           MOVE ACCT-CURR-CYC-CREDIT     TO ACUP-OLD-CURR-CYC-CREDIT-N\n      * Current Cycle Debit\n           MOVE ACCT-CURR-CYC-DEBIT      TO ACUP-OLD-CURR-CYC-DEBIT-N\n      * Open date\n      *    MOVE ACCT-OPEN-DATE           TO ACUP-OLD-OPEN-DATE\n           MOVE ACCT-OPEN-DATE(1:4)      TO ACUP-OLD-OPEN-YEAR\n           MOVE ACCT-OPEN-DATE(6:2)      TO ACUP-OLD-OPEN-MON\n           MOVE ACCT-OPEN-DATE(9:2)      TO ACUP-OLD-OPEN-DAY\n      * Expiry date\n      *    MOVE ACCT-EXPIRAION-DATE      TO ACUP-OLD-EXPIRAION-DATE\n           MOVE ACCT-EXPIRAION-DATE(1:4) TO ACUP-OLD-EXP-YEAR\n           MOVE ACCT-EXPIRAION-DATE(6:2) TO ACUP-OLD-EXP-MON\n           MOVE ACCT-EXPIRAION-DATE(9:2) TO ACUP-OLD-EXP-DAY\n\n      * Reissue date\n      *    MOVE ACCT-REISSUE-DATE        TO ACUP-OLD-REISSUE-DATE\n           MOVE ACCT-REISSUE-DATE(1:4)   TO ACUP-OLD-REISSUE-YEAR\n           MOVE ACCT-REISSUE-DATE(6:2)   TO ACUP-OLD-REISSUE-MON\n           MOVE ACCT-REISSUE-DATE(9:2)   TO ACUP-OLD-REISSUE-DAY\n      * Account Group\n           MOVE ACCT-GROUP-ID            TO ACUP-OLD-GROUP-ID\n      ******************************************************************\n      *    Customer Master data\n      ******************************************************************\n      *Customer Id (actually not editable)\n           MOVE CUST-ID                  TO ACUP-OLD-CUST-ID\n      *Social Security Number\n           MOVE CUST-SSN                 TO ACUP-OLD-CUST-SSN\n      *Date of birth\n      *    MOVE CUST-DOB-YYYY-MM-DD      TO ACUP-OLD-CUST-DOB-YYYY-MM-DD\n           MOVE CUST-DOB-YYYY-MM-DD(1:4) TO ACUP-OLD-CUST-DOB-YEAR\n           MOVE CUST-DOB-YYYY-MM-DD(6:2) TO ACUP-OLD-CUST-DOB-MON\n           MOVE CUST-DOB-YYYY-MM-DD(9:2) TO ACUP-OLD-CUST-DOB-DAY\n      *FICO\n           MOVE CUST-FICO-CREDIT-SCORE   TO ACUP-OLD-CUST-FICO-SCORE\n      *First Name\n           MOVE CUST-FIRST-NAME          TO ACUP-OLD-CUST-FIRST-NAME\n      *Middle Name\n           MOVE CUST-MIDDLE-NAME         TO ACUP-OLD-CUST-MIDDLE-NAME\n      *Last Name\n           MOVE CUST-LAST-NAME           TO ACUP-OLD-CUST-LAST-NAME\n      *Address\n           MOVE CUST-ADDR-LINE-1         TO ACUP-OLD-CUST-ADDR-LINE-1\n           MOVE CUST-ADDR-LINE-2         TO ACUP-OLD-CUST-ADDR-LINE-2\n           MOVE CUST-ADDR-LINE-3         TO ACUP-OLD-CUST-ADDR-LINE-3\n           MOVE CUST-ADDR-STATE-CD       TO ACUP-OLD-CUST-ADDR-STATE-CD\n           MOVE CUST-ADDR-COUNTRY-CD     TO\n                                          ACUP-OLD-CUST-ADDR-COUNTRY-CD\n           MOVE CUST-ADDR-ZIP            TO ACUP-OLD-CUST-ADDR-ZIP\n           MOVE CUST-PHONE-NUM-1         TO ACUP-OLD-CUST-PHONE-NUM-1\n           MOVE CUST-PHONE-NUM-2         TO ACUP-OLD-CUST-PHONE-NUM-2\n      *Government Id\n           MOVE CUST-GOVT-ISSUED-ID      TO ACUP-OLD-CUST-GOVT-ISSUED-ID\n      *EFT Code\n           MOVE CUST-EFT-ACCOUNT-ID      TO ACUP-OLD-CUST-EFT-ACCOUNT-ID\n      *Primary Holder Indicator\n           MOVE CUST-PRI-CARD-HOLDER-IND TO ACUP-OLD-CUST-PRI-HOLDER-IND\n           .\n",
        "paragraph_lines": [3749, 3832],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Stores account and customer context data into the communication area for transaction processing.",
          "Initializes the old account details structure to prevent residual data issues.",
          "Copies essential account data (e.g., account ID, status, balance, limits) into respective old account fields.",
          "Extracts and moves date components (e.g., open date, expiration date) to the old account details for clear interpretation.",
          "Transfers comprehensive customer details (e.g., customer ID, SSN, name, address) into the old customer details area.",
          "Populates additional customer fields such as phone numbers, government ID, and primary cardholder indicator for complete recordkeeping."
        ]
      },
      "9500-STORE-FETCHED-DATA-EXIT": {
        "paragraph_name": "9500-STORE-FETCHED-DATA-EXIT",
        "section": "procedure division",
        "paragraph_code": "9500-STORE-FETCHED-DATA-EXIT.\n           EXIT\n           .\n",
        "paragraph_lines": [3833, 3835],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the current paragraph logic without performing any additional actions."
        ]
      },
      "9600-WRITE-PROCESSING": {
        "paragraph_name": "9600-WRITE-PROCESSING",
        "section": "procedure division",
        "paragraph_code": "9600-WRITE-PROCESSING.\n\n      *    Read the account file for update\n\n           MOVE CC-ACCT-ID              TO WS-CARD-RID-ACCT-ID\n\n           EXEC CICS READ\n                FILE      (LIT-ACCTFILENAME)\n                UPDATE\n                RIDFLD    (WS-CARD-RID-ACCT-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-ACCT-ID-X)\n                INTO      (ACCOUNT-RECORD)\n                LENGTH    (LENGTH OF ACCOUNT-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n      *****************************************************************\n      *    Could we lock the account record ?\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                    TO TRUE\n              IF  WS-RETURN-MSG-OFF\n                  SET COULD-NOT-LOCK-ACCT-FOR-UPDATE  TO TRUE\n              END-IF\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      *    Read the customer file for update\n\n           MOVE CDEMO-CUST-ID                   TO WS-CARD-RID-CUST-ID\n\n           EXEC CICS READ\n                FILE      (LIT-CUSTFILENAME)\n                UPDATE\n                RIDFLD    (WS-CARD-RID-CUST-ID-X)\n                KEYLENGTH (LENGTH OF WS-CARD-RID-CUST-ID-X)\n                INTO      (CUSTOMER-RECORD)\n                LENGTH    (LENGTH OF CUSTOMER-RECORD)\n                RESP      (WS-RESP-CD)\n                RESP2     (WS-REAS-CD)\n           END-EXEC\n      *****************************************************************\n      *    Could we lock the customer record ?\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n              CONTINUE\n           ELSE\n              SET INPUT-ERROR                    TO TRUE\n              IF  WS-RETURN-MSG-OFF\n                  SET COULD-NOT-LOCK-CUST-FOR-UPDATE  TO TRUE\n              END-IF\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      *****************************************************************\n      *    Did someone change the record while we were out ?\n      *****************************************************************\n           PERFORM 9700-CHECK-CHANGE-IN-REC\n              THRU 9700-CHECK-CHANGE-IN-REC-EXIT\n\n           IF DATA-WAS-CHANGED-BEFORE-UPDATE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n      *****************************************************************\n      * Prepare the update\n      *****************************************************************\n           INITIALIZE ACCT-UPDATE-RECORD\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           MOVE ACUP-NEW-ACCT-ID         TO ACCT-UPDATE-ID\n      * Active Status\n           MOVE ACUP-NEW-ACTIVE-STATUS   TO ACCT-UPDATE-ACTIVE-STATUS\n      * Current Balance\n           MOVE ACUP-NEW-CURR-BAL-N OF ACUP-NEW-DETAILS\n                TO ACCT-UPDATE-CURR-BAL\n      * Credit Limit\n           MOVE ACUP-NEW-CREDIT-LIMIT-N  TO ACCT-UPDATE-CREDIT-LIMIT\n      * Cash Limit\n           MOVE ACUP-NEW-CASH-CREDIT-LIMIT-N\n                                      TO ACCT-UPDATE-CASH-CREDIT-LIMIT\n      * Current Cycle Credit\n           MOVE ACUP-NEW-CURR-CYC-CREDIT-N\n                                          TO ACCT-UPDATE-CURR-CYC-CREDIT\n      * Current Cycle Debit\n           MOVE ACUP-NEW-CURR-CYC-DEBIT-N TO ACCT-UPDATE-CURR-CYC-DEBIT\n      * Open date\n           STRING ACUP-NEW-OPEN-YEAR\n                  '-'\n                  ACUP-NEW-OPEN-MON\n                  '-'\n                  ACUP-NEW-OPEN-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-OPEN-DATE\n      * Expiry date\n           STRING ACUP-NEW-EXP-YEAR\n                  '-'\n                  ACUP-NEW-EXP-MON\n                  '-'\n                  ACUP-NEW-EXP-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-EXPIRAION-DATE\n\n      * Reissue date\n           MOVE ACCT-REISSUE-DATE        TO ACCT-UPDATE-REISSUE-DATE\n           STRING ACUP-NEW-REISSUE-YEAR\n                  '-'\n                  ACUP-NEW-REISSUE-MON\n                  '-'\n                  ACUP-NEW-REISSUE-DAY\n           DELIMITED BY SIZE\n                                       INTO ACCT-UPDATE-REISSUE-DATE\n      * Account Group\n           MOVE ACUP-NEW-GROUP-ID        TO ACCT-UPDATE-GROUP-ID\n\n      ******************************************************************\n      *    Customer data\n      ******************************************************************\n           INITIALIZE CUST-UPDATE-RECORD\n\n           MOVE  ACUP-NEW-CUST-ID        TO CUST-UPDATE-ID\n           MOVE  ACUP-NEW-CUST-FIRST-NAME\n                                   TO CUST-UPDATE-FIRST-NAME\n           MOVE  ACUP-NEW-CUST-MIDDLE-NAME\n                                   TO CUST-UPDATE-MIDDLE-NAME\n           MOVE  ACUP-NEW-CUST-LAST-NAME TO CUST-UPDATE-LAST-NAME\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-1\n                                   TO CUST-UPDATE-ADDR-LINE-1\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-2\n                                   TO CUST-UPDATE-ADDR-LINE-2\n           MOVE  ACUP-NEW-CUST-ADDR-LINE-3\n                                   TO CUST-UPDATE-ADDR-LINE-3\n           MOVE  ACUP-NEW-CUST-ADDR-STATE-CD\n                                   TO CUST-UPDATE-ADDR-STATE-CD\n           MOVE  ACUP-NEW-CUST-ADDR-COUNTRY-CD\n                                   TO CUST-UPDATE-ADDR-COUNTRY-CD\n           MOVE  ACUP-NEW-CUST-ADDR-ZIP  TO CUST-UPDATE-ADDR-ZIP\n\n           STRING '(',\n                  ACUP-NEW-CUST-PHONE-NUM-1A,\n                  ')',\n                  ACUP-NEW-CUST-PHONE-NUM-1B,\n                  '-',\n                  ACUP-NEW-CUST-PHONE-NUM-1C\n           DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-1\n\n           STRING '(',\n                  ACUP-NEW-CUST-PHONE-NUM-2A,\n                  ')',\n                  ACUP-NEW-CUST-PHONE-NUM-2B,\n                  '-',\n                  ACUP-NEW-CUST-PHONE-NUM-2C\n           DELIMITED BY SIZE    INTO CUST-UPDATE-PHONE-NUM-2\n\n\n           MOVE  ACUP-NEW-CUST-SSN       TO CUST-UPDATE-SSN\n           MOVE  ACUP-NEW-CUST-GOVT-ISSUED-ID\n                                   TO CUST-UPDATE-GOVT-ISSUED-ID\n           STRING ACUP-NEW-CUST-DOB-YEAR\n                  '-'\n                  ACUP-NEW-CUST-DOB-MON\n                  '-'\n                  ACUP-NEW-CUST-DOB-DAY\n           DELIMITED BY SIZE           INTO CUST-UPDATE-DOB-YYYY-MM-DD\n\n           MOVE ACUP-NEW-CUST-EFT-ACCOUNT-ID\n                                         TO CUST-UPDATE-EFT-ACCOUNT-ID\n           MOVE ACUP-NEW-CUST-PRI-HOLDER-IND\n                                         TO CUST-UPDATE-PRI-CARD-IND\n           MOVE ACUP-NEW-CUST-FICO-SCORE TO\n                                   CUST-UPDATE-FICO-CREDIT-SCORE\n      *****************************************************************\n      * Update account *\n      *****************************************************************\n\n\n           EXEC CICS\n                REWRITE FILE(LIT-ACCTFILENAME)\n                        FROM(ACCT-UPDATE-RECORD)\n                        LENGTH(LENGTH OF ACCT-UPDATE-RECORD)\n                        RESP      (WS-RESP-CD)\n                        RESP2     (WS-REAS-CD)\n           END-EXEC.\n      *\n      *****************************************************************\n      * Did account update succeed ?  *\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n             CONTINUE\n           ELSE\n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE\n             GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n      *****************************************************************\n      * Update customer *\n      *****************************************************************\n           EXEC CICS\n                        REWRITE FILE(LIT-CUSTFILENAME)\n                        FROM(CUST-UPDATE-RECORD)\n                        LENGTH(LENGTH OF CUST-UPDATE-RECORD)\n                        RESP      (WS-RESP-CD)\n                        RESP2     (WS-REAS-CD)\n           END-EXEC.\n      *****************************************************************\n      * Did customer update succeed ? *\n      *****************************************************************\n           IF WS-RESP-CD EQUAL TO DFHRESP(NORMAL)\n             CONTINUE\n           ELSE\n             SET LOCKED-BUT-UPDATE-FAILED    TO TRUE\n             EXEC CICS\n                SYNCPOINT ROLLBACK\n             END-EXEC\n             GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n           .\n",
        "paragraph_lines": [3836, 4053],
        "ref_paragraphs": ["9700-CHECK-CHANGE-IN-REC", "9700-CHECK-CHANGE-IN-REC-EXIT"],
        "paragraph_logic": [
          "Reads the account file for update and checks if the account record can be locked.",
          "Reads the customer file for update and checks if the customer record can be locked.",
          "Performs a check to ensure no one has changed the records while they were retrieved.",
          "Updates various fields in the account and customer records before committing the changes.",
          "Attempts to rewrite the account record and checks if the update succeeded.",
          "Attempts to rewrite the customer record, ensuring the update succeeded, and rolls back if it failed."
        ]
      },
      "9600-WRITE-PROCESSING-EXIT": {
        "paragraph_name": "9600-WRITE-PROCESSING-EXIT",
        "section": "procedure division",
        "paragraph_code": "9600-WRITE-PROCESSING-EXIT.\n           EXIT\n           .\n\n",
        "paragraph_lines": [4054, 4056],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the [write processing section]<9600-WRITE-PROCESSING-EXIT> to mark the end of its operations."
        ]
      },
      "9700-CHECK-CHANGE-IN-REC": {
        "paragraph_name": "9700-CHECK-CHANGE-IN-REC",
        "section": "procedure division",
        "paragraph_code": "9700-CHECK-CHANGE-IN-REC.\n\n\n      ******************************************************************\n      *    Account Master data\n      ******************************************************************\n           IF  ACCT-ACTIVE-STATUS      EQUAL ACUP-OLD-ACTIVE-STATUS\n      * Current Balance\n           AND ACCT-CURR-BAL           EQUAL ACUP-OLD-CURR-BAL-N\n      * Credit Limit\n           AND ACCT-CREDIT-LIMIT       EQUAL ACUP-OLD-CREDIT-LIMIT-N\n      * Cash Limit\n           AND ACCT-CASH-CREDIT-LIMIT EQUAL ACUP-OLD-CASH-CREDIT-LIMIT-N\n      * Current Cycle Credit\n           AND ACCT-CURR-CYC-CREDIT    EQUAL ACUP-OLD-CURR-CYC-CREDIT-N\n      * Current Cycle Debit\n           AND ACCT-CURR-CYC-DEBIT     EQUAL ACUP-OLD-CURR-CYC-DEBIT-N\n      * Open date\n           AND ACCT-OPEN-DATE(1:4)     EQUAL ACUP-OLD-OPEN-YEAR\n           AND ACCT-OPEN-DATE(6:2)     EQUAL ACUP-OLD-OPEN-MON\n           AND ACCT-OPEN-DATE(9:2)     EQUAL ACUP-OLD-OPEN-DAY\n      * Expiry date\n           AND ACCT-EXPIRAION-DATE(1:4)EQUAL ACUP-OLD-EXP-YEAR\n           AND ACCT-EXPIRAION-DATE(6:2)EQUAL ACUP-OLD-EXP-MON\n           AND ACCT-EXPIRAION-DATE(9:2)EQUAL ACUP-OLD-EXP-DAY\n      * Reissue date\n           AND ACCT-REISSUE-DATE(1:4)  EQUAL ACUP-OLD-REISSUE-YEAR\n           AND ACCT-REISSUE-DATE(6:2)  EQUAL ACUP-OLD-REISSUE-MON\n           AND ACCT-REISSUE-DATE(9:2)  EQUAL ACUP-OLD-REISSUE-DAY\n      * Account Group\n           AND FUNCTION LOWER-CASE (ACCT-GROUP-ID)           EQUAL\n               FUNCTION LOWER-CASE (ACUP-OLD-GROUP-ID)\n               CONTINUE\n           ELSE\n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n\n      ******************************************************************\n      *    Customer  data - Split into 2 IFs for easier reading\n      *    And maybe put logic to update only 1 file if only date\n      *    pertaining to one of them is updated\n      ******************************************************************\n           IF  FUNCTION UPPER-CASE (CUST-FIRST-NAME          ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-FIRST-NAME )\n           AND FUNCTION UPPER-CASE (CUST-MIDDLE-NAME         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-MIDDLE-NAME)\n           AND FUNCTION UPPER-CASE (CUST-LAST-NAME           ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-LAST-NAME  )\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-1         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-1)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-2         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-2)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-LINE-3         ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-LINE-3)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-STATE-CD       ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-STATE-CD)\n           AND FUNCTION UPPER-CASE (CUST-ADDR-COUNTRY-CD     ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-ADDR-COUNTRY-CD )\n           AND CUST-ADDR-ZIP           EQUAL ACUP-OLD-CUST-ADDR-ZIP\n           AND CUST-PHONE-NUM-1        EQUAL ACUP-OLD-CUST-PHONE-NUM-1\n           AND CUST-PHONE-NUM-2        EQUAL ACUP-OLD-CUST-PHONE-NUM-2\n           AND CUST-SSN                EQUAL ACUP-OLD-CUST-SSN\n           AND FUNCTION UPPER-CASE (CUST-GOVT-ISSUED-ID      ) EQUAL\n               FUNCTION UPPER-CASE (ACUP-OLD-CUST-GOVT-ISSUED-ID )\n           AND CUST-DOB-YYYY-MM-DD (1:4)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (1:4)\n           AND CUST-DOB-YYYY-MM-DD (6:2)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (5:2)\n           AND CUST-DOB-YYYY-MM-DD (9:2)                       EQUAL\n               ACUP-OLD-CUST-DOB-YYYY-MM-DD (7:2)\n\n           AND CUST-EFT-ACCOUNT-ID     EQUAL\n                                            ACUP-OLD-CUST-EFT-ACCOUNT-ID\n           AND CUST-PRI-CARD-HOLDER-IND\n                                       EQUAL\n                                            ACUP-OLD-CUST-PRI-HOLDER-IND\n           AND CUST-FICO-CREDIT-SCORE  EQUAL ACUP-OLD-CUST-FICO-SCORE\n               CONTINUE\n           ELSE\n              SET DATA-WAS-CHANGED-BEFORE-UPDATE TO TRUE\n              GO TO 9600-WRITE-PROCESSING-EXIT\n           END-IF\n           .\n",
        "paragraph_lines": [4058, 4141],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Checks if the active status of the account remains unchanged.",
          "Compares current balance, credit limit, cash credit limit, current cycle credit, and current cycle debit with old values.",
          "Validates the accounts open date, expiration date, and reissue date against old dates.",
          "Compares account group ID in a case-insensitive manner.",
          "Checks customer-related details including name, address, phone numbers, SSN, and government issued ID for any changes.",
          "Verifies other customer details like date of birth, EFT account ID, primary card holder indicator, and FICO credit score are unchanged."
        ]
      },
      "9700-CHECK-CHANGE-IN-REC-EXIT": {
        "paragraph_name": "9700-CHECK-CHANGE-IN-REC-EXIT",
        "section": "procedure division",
        "paragraph_code": "9700-CHECK-CHANGE-IN-REC-EXIT.\n           EXIT\n           .\n      ******************************************************************\n      *Common code to store PFKey\n      ******************************************************************\n       COPY 'CSSTRPFY'\n           .\n\n\n",
        "paragraph_lines": [4142, 4149],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Exits the 9700-CHECK-CHANGE-IN-REC paragraph.",
          "Includes common code to handle storing the PFKey by copying CSSTRPFY."
        ]
      },
      "ABEND-ROUTINE": {
        "paragraph_name": "ABEND-ROUTINE",
        "section": "procedure division",
        "paragraph_code": "ABEND-ROUTINE.\n\n           IF ABEND-MSG EQUAL LOW-VALUES\n              MOVE 'UNEXPECTED ABEND OCCURRED.' TO ABEND-MSG\n           END-IF\n\n           MOVE LIT-THISPGM       TO ABEND-CULPRIT\n\n           EXEC CICS SEND\n                            FROM (ABEND-DATA)\n                            LENGTH(LENGTH OF ABEND-DATA)\n                            NOHANDLE\n                            ERASE\n           END-EXEC\n\n           EXEC CICS HANDLE ABEND\n                CANCEL\n           END-EXEC\n\n           EXEC CICS ABEND\n                ABCODE('9999')\n           END-EXEC\n           .\n",
        "paragraph_lines": [4152, 4174],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Checks if the ABEND message is empty and sets a default message if it is.",
          "Moves the current program name to the ABEND culprit variable.",
          "Sends the ABEND data to the terminal without handling any response or errors and erases the screen.",
          "Cancels any currently active ABEND handling routings.",
          "Initiates an ABEND with the specified ABCODE 9999 to terminate the transaction."
        ]
      },
      "ABEND-ROUTINE-EXIT": {
        "paragraph_name": "ABEND-ROUTINE-EXIT",
        "section": "procedure division",
        "paragraph_code": "ABEND-ROUTINE-EXIT.\n           EXIT\n           .\n      ******************************************************************\n      * Common Date Routines\n      ******************************************************************\n       COPY CSUTLDPY\n           .\n",
        "paragraph_lines": [4175, 4182],
        "ref_paragraphs": [],
        "paragraph_logic": [
          "Marks the exit point of the abend routine.",
          "Executes an EXIT statement to terminate the abend routine.",
          "Includes a copybook CSUTLDPY which likely contains common date processing routines."
        ]
      }
    }
  },
  "copy_graph": {
    "programs": [
      {
        "index": 0,
        "program_id": "'CSUTLDWY'",
        "program_type": "Copy",
        "program_name": "'CSUTLDWY'",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 1,
        "program_id": "CVCRD01Y",
        "program_type": "Copy",
        "program_name": "CVCRD01Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 2,
        "program_id": "CSLKPCDY",
        "program_type": "Copy",
        "program_name": "CSLKPCDY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 3,
        "program_id": "DFHBMSCA",
        "program_type": "Copy",
        "program_name": "DFHBMSCA",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 4,
        "program_id": "DFHAID",
        "program_type": "Copy",
        "program_name": "DFHAID",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 5,
        "program_id": "COTTL01Y",
        "program_type": "Copy",
        "program_name": "COTTL01Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 6,
        "program_id": "COACTUP",
        "program_type": "Copy",
        "program_name": "COACTUP",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 7,
        "program_id": "CSDAT01Y",
        "program_type": "Copy",
        "program_name": "CSDAT01Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 8,
        "program_id": "CSMSG01Y",
        "program_type": "Copy",
        "program_name": "CSMSG01Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 9,
        "program_id": "CSMSG02Y",
        "program_type": "Copy",
        "program_name": "CSMSG02Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 10,
        "program_id": "CSUSR01Y",
        "program_type": "Copy",
        "program_name": "CSUSR01Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 11,
        "program_id": "CVACT01Y",
        "program_type": "Copy",
        "program_name": "CVACT01Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 12,
        "program_id": "CVACT03Y",
        "program_type": "Copy",
        "program_name": "CVACT03Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 13,
        "program_id": "CVCUS01Y",
        "program_type": "Copy",
        "program_name": "CVCUS01Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 14,
        "program_id": "COCOM01Y",
        "program_type": "Copy",
        "program_name": "COCOM01Y",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 15,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 16,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 17,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 18,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 19,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 20,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 21,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 22,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 23,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 24,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 25,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 26,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 27,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 28,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 29,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 30,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 31,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 32,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 33,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 34,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 35,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 36,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 37,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 38,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 39,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 40,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 41,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 42,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 43,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 44,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 45,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 46,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 47,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 48,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 49,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 50,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 51,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 52,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 53,
        "program_id": "CSSETATY",
        "program_type": "Copy",
        "program_name": "CSSETATY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 54,
        "program_id": "'CSSTRPFY'",
        "program_type": "Copy",
        "program_name": "'CSSTRPFY'",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      },
      {
        "index": 55,
        "program_id": "CSUTLDPY",
        "program_type": "Copy",
        "program_name": "CSUTLDPY",
        "call_type": "Static Call",
        "notes": "",
        "locations": "",
        "paragraph": "",
        "identifier": []
      }
    ],
    "details": [""]
  }
}
